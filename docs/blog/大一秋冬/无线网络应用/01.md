第五次课

### 一、WLAN 易受攻击的原因及典型攻击方式

-  （一）易受攻击的核心原因

     1. 连接便捷性的反向弊端：无线网络无需物理接线即可接入，但其信息通过空间传输，无实体边界防护，极易被拦截。
     2. 攻击无地域限制：攻击者可在无线信号覆盖范围内的任意地点，尝试访问目标网络，甚至能直接利用 “开放式” 网络免费接入互联网。

- （二）典型攻击手段

     1. 驾驶攻击：攻击者驾车在某区域内搜索无线 LAN，发现后会记录并共享网络地址，目的是暴露多数无线网络的安全漏洞，同时体现 WLAN 技术的普及性。
     2. 战争漫步：与驾驶攻击逻辑类似，攻击者通过步行巡查区域寻找无线接入点，并用粉笔在接入点地址处做标记，以此标识无线连接的状态。
     3. MAC 地址克隆：攻击者可修改自身设备的 MAC 地址（即 MAC 地址 “哄骗 / 伪装”），克隆已获得网络访问权限的设备 MAC，从而绕过 MAC 地址过滤机制。在 Windows 系统中，有线网卡可通过网卡属性的 “高级” 选项卡修改 MAC 地址，无线网卡修改则有格式限制（第 2 位数字需为 2、6、A、E）。

### 二、WLAN 基础安全防护措施

这类措施是 WLAN 安全的基础，但均存在一定局限性，具体如下：

1. 修改默认设置
    - 核心操作：更改无线路由器 / AP 的默认 SSID（网络名称）、密码和 IP 地址，例如将默认 SSID “Default” 改为 “Z1nflTm”，默认密码改为 “str8#210”，避免攻击者利用通用默认信息入侵。
    - 局限性：SSID 以明文形式传输，即便修改了默认值，攻击者仍可拦截通信信号获取 SSID，无法从根本上保障安全。
2. 禁用 SSID 广播
    - 核心操作：关闭 AP 的 SSID 广播功能，使普通设备无法自动扫描到该网络。
    - 局限性：无法阻止攻击者拦截正在通信的无线信号，仍能从中解析出 SSID，进而尝试连接网络。
3. MAC 地址过滤
    - 核心操作：在 AP 中配置 MAC 地址白名单，仅允许列表内的设备接入网络，实现对接入设备的精准管控。
    - 局限性：一方面，需提前将所有合法设备的 MAC 地址录入列表，否则无法接入，配置繁琐；另一方面，MAC 地址可被克隆，无法抵御地址伪装攻击。

### 三、WLAN 身份验证机制

身份验证用于确认接入设备的可信度，是控制网络接入权限的关键手段，主要有三类方式：

1. 开放式身份验证
    - 核心逻辑：默认的无线设备身份验证方式，不要求客户端提供身份凭证，只要知晓 SSID 即可关联网络。
    - 典型场景：如校园的 ZJUWLAN、ZJUWLAN-NEW，这类网络通常在连接后会跳转至网页进行二次身份验证。
    - 局限性：无严格身份校验，安全性极低，仅能作为基础接入门槛。
2. PSK（预共享密钥）身份验证
    - 核心逻辑：AP 与客户端需配置相同的密钥 / 密码，仅支持单向身份验证（仅客户端向 AP 验证身份）。
    - 典型场景：普通无线热点，用户只需输入统一密码即可接入。
    - 局限性：密钥若泄露则全网面临风险，且无 AP 向客户端的身份验证，易遭遇伪 AP 攻击。
3. EAP（可扩展身份验证协议）
    - 核心逻辑：支持双向身份验证，同时可实现用户级身份验证，身份验证请求会转发至专业后端服务器（如 RADIUS 服务器）处理。
    - 典型场景：校园的 ZJUWLAN-Secure，采用 “802.1X + EAP” 模式，安全性更高。
    - 优先级规则：若同时启用身份验证和 MAC 地址过滤，会先完成身份验证，再校验 MAC 地址是否在白名单内。

### 四、WLAN 数据加密技术

身份验证和 MAC 过滤无法防止数据被拦截窃听，加密技术可对传输数据进行保护，其技术迭代历程如下：

1. WEP（有线等效协议）
    - 核心机制：采用 RC4 加密算法，使用 64/128/256 位静态密钥，AP 与客户端需配置相同密钥才能解密数据。
    - 严重缺陷：密钥为静态且可被专业软件破解，安全性极差，仅能实现基础加密，无法抵御高级攻击。
    - 补救方案：可通过频繁更换密钥提升安全性，但操作成本高。
2. WPA（Wi-Fi 保护访问）
    - 核心机制：使用 64-256 位密钥，且客户端与 AP 建立连接时会生成动态随机密钥（仅本次连接有效），加密算法比 WEP 更复杂，破解难度大幅提升。
    - 定位：作为 WEP 到 WPA2 的过渡加密技术，弥补了 WEP 的核心漏洞。
3. WPA2
    - 核心机制：基于 802.11i 标准，采用四次握手过程协商动态加密密钥，每次连接的密钥均不重复，常用模式为 WPA2/PSK（预共享密钥模式），输入的密码为 PSK 身份验证密码，非实际加密密钥。
    - 安全漏洞：
        - KRACK 攻击（密钥重安装攻击）：171016 被曝光，攻击者可伪造伪 AP（SSID 相同、信道不同），强制客户端断开与正常 AP 的连接并切换至伪 AP 信道，在四次握手阶段重放旧密钥信息，诱骗客户端重装旧密钥，进而实施中间人攻击，窃取 HTTP 明文数据。该攻击主要针对无线客户端，默认模式的 AP 不受影响，且 HTTPS、VPN、SSH 等加密连接可抵御此攻击。
        - PMKID 攻击：180808 被发现，攻击者无需等待用户连接，可通过单个 EAPOL 帧的 RSN IE 信息破解 WPA/WPA2 路由器的 PSK 密码，进而窃取数据或实施中间人攻击。
    - 厂商修复：微软、苹果、谷歌等厂商已通过系统补丁修复该漏洞。
4. WPA3
    - 推出背景：为解决 WPA2 的 KRACK 漏洞，WiFi 联盟于 2018 年 1 月发布 WPA3，6 月完成协议定稿。
    - 核心升级：
        - 安全套件从 128bit 升级至 192bit，加密强度提升；
        - 用 Dragonfly 交握（SAE 对等实体同时验证） 取代四次握手，将认证与密钥交换合一，无需 PSK 或 PKI（公钥基础设施）即可安全建立共享密钥；
        - 支持为不同设备分配独立密钥，降低单密钥泄露的影响范围。
    - 支持设备：高通骁龙 845 及后续旗舰平台、iPhone X 及后续机型、华为全系 WiFi 设备、TP-LINK TL-XDR1860 等路由器均支持 WPA3。
    - 安全漏洞：190412 被曝光DRAGONBLOOD 漏洞（含 5 个漏洞），190807 又新增 2 个漏洞，不过 WiFi 联盟已发布修补程序，可通过固件更新缓解风险。

### 五、WLAN 通信过滤

通信过滤用于管控网络内的数据传输流向，拦截可疑通信，具体功能如下：

1. 可针对特定 IP 地址或 MAC 地址，拦截其传入或传出的通信数据；
2. 可通过端口号拦截特定应用 / 服务，例如拦截发往 Radius 服务器的 Telnet 通信（端口 23），防范针对认证服务器的可疑访问。

### 六、补充技术：国产 WAPI 协议

WAPI（无线局域网鉴别和保密基础结构）是我国自主研发的 WLAN 安全标准，具有完全自主知识产权，核心信息如下：

1. 发展历程
    - 1992 年我国启动 WLAN 研究，1994 年研制出首台 WLAN 样机；2003 年发布国家强制标准 GB 15629.11/1102-2003；2009 年成为 ISO/IEC 认可的国际标准；截至 2019 年，全球支持 WAPI 的芯片超 500 款、出货量超 140 亿颗，终端设备超 14000 款，国行 iPhone 等终端均已支持 WAPI。
    - 发展过程中曾遭遇美国阻挠，美国曾要求我国放弃 WAPI 标准，还在 ISO 会议期间拒绝为中方技术人员发放签证。
2. 与 WiFi（802.11i）的核心区别

    | 对比项目 | WAPI                                                                            | IEEE 802.11i（WiFi 标准）                                                |
    | -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
    | 鉴别机制 | 双向鉴别（AP 与移动终端通过认证服务器 AS 实现相互认证）        | 单向 / 双向鉴别（仅移动终端与 Radius 服务器间，终端无法鉴别 AP 合法性） |
    | 鉴别方法 | 过程简单，采用公钥数字证书，用户与 AP 地位对等，支持多证书漫游 | 过程复杂，采用用户名 + 口令验证，由 Radius 服务器完成用户认证 |
    | 密钥管理 | 全集中管理（由 AS 统一管控局域网内密钥）                            | AP 与 Radius 服务器需手工配置共享密钥，厂商实现方案可能不兼容，兼容性成本高 |
    | 安全漏洞 | 未查明                                                                         | 身份凭证易被盗取，共享密钥管理存在隐患                              |
    | 加密算法 | 国密办批准的 SMS4 分组加密算法                                         | 128bit AES 或 128bit RC4 算法                                          |

3. 核心价值
    - 国家安全：棱镜门事件暴露美国的标准监控风险，WAPI 的双向加密认证比 WiFi 的单向认证更安全，且采用国密算法，可保障国家信息安全；
    - 经济利益：打破国外标准垄断，改变我国在 DVD、3G/4G 等领域的专利被动局面，WAPI 产业链已覆盖芯片、终端、运营商设备，在电力、金融等行业广泛推广。

### 七、补充技术：星闪技术的安全性

星闪（SparkLink 1.0）无线短距通信技术不追求 “一劳永逸” 的单一安全方案，而是通过全周期防护保障通信安全，核心安全机制如下：

1. 加密与认证：采用高强度加密算法保障数据机密性，支持双向身份认证防范中间人攻击，且会话密钥可动态更新；
2. 抗干扰与隐私保护：通过自适应跳频技术抗干扰、防窃听，支持隐私模式（隐藏 MAC 或使用临时标识符）避免用户被追踪；
3. 物理层增强：高精度时间同步实现精准时隙调度，减少信号碰撞和截获概率；超低时延（<20μs）缩短传输窗口，降低攻击者捕捉数据的可能性；
4. 协议与架构安全：分层加密设计（从物理层到应用层逐级防护），隔离层级风险；遵循最小权限原则，限制设备越权访问。

### 八、WLAN 安全技术里程碑与优先级

1. 技术迭代顺序：开放式访问（无加密、无严格认证）→ WEP（第一代加密，静态密钥可破解）→ WPA（过渡技术，动态密钥 + 改进加密）→ WPA2/WPA3（最新技术，强加密 + 严格身份验证）；
2. 安全优先级：WPA3 优于 WPA2 优于 WPA；AES 加密算法优于 TKIP；SAE 身份验证优于 PSK；
3. 常见设备安全模式：TP-LINK 设备一般支持 WEP（RC4 加密）、WPA/WPA2（TKIP/AES 加密 + 802.1X EAP 认证）、WPA-PSK/WPA2-PSK/WPA3-SAE（TKIP/AES 加密 + PSK/SAE 认证）三类模式。