实验六：无线流媒体服务配置应用及虚拟 WiFi 组网共享上网实验详细梳理

- 核心结论：本实验包含两大核心模块，一是通过无线路由器实现多设备无线互联，完成共享文件夹、远程桌面连接、流媒体服务配置三大子实验；二是利用 Connectify Hotspot 软件搭建虚拟 WiFi，实现多设备共享上网，覆盖 Windows、手机（安卓/苹果）等多终端操作。

- 实验核心前提与基础配置

    - 实验环境
        - 硬件：至少 3 台 PC（支持无线网卡）、无线路由器、手机/平板（安卓/苹果可选）。
        - 软件：Windows Server 2019/Win10/11 系统、IIS 媒体服务、Connectify Hotspot、Windows Media Player/PotPlayer、ES 文件浏览器/VLC 等终端 App。
        - 网络：无线路由器支持 5GHz 频段，主机需接入校网（wlan/5G）或外网（ZJUWLAN+VPN）。

    - 基础网络配置（两大实验通用）
        - 子网掩码统一为 255.255.255.0。
        - 无线路由器 LAN 口 IP 地址固定为 192.168.1.1，启用 DHCP 服务器（地址池 192.168.1.100-192.168.1.199，租期 120 分钟）。
        - 有线网卡均禁用，所有设备通过无线连接无线路由器或虚拟 WiFi。

- 无线流媒体服务配置应用实验（模块一）

    - 核心目标
        - 实现 3 台 PC 及手机终端的无线互联，完成文件夹共享、远程桌面访问、流媒体点播三大功能。

    - 基础互联配置（实验 0）
        - PC 静态 IP 设置
            - PC1：无线网卡 IP 192.168.1.11，默认网关 192.168.1.1，DNS 为空。
            - PC2：无线网卡 IP 192.168.1.22，默认网关 192.168.1.1，DNS 为空。
            - PC3：无线网卡 IP 192.168.1.33，默认网关 192.168.1.1，DNS 为空。

        - 无线路由器配置
            - 频段设置为 5GHz（按组指定信道），配置 SSID（自定义）。
            - 开启 DHCP 服务器，网关设为 192.168.1.1，DNS 设为 0.0.0.0。
            - 验证：三台 PC 互相 ping 通（如 PC1 ping 192.168.1.22，丢包率 0%）。

    - 子实验 1：共享文件夹（跨设备文件访问）
        - PC 端共享设置（以 PC1 为例）
            - 选中目标文件夹（如 C:\share），右键→属性→共享→点击“共享”按钮。
            - 选择用户（Administrator 默认拥有读写权限），设置权限（读取/读取+写入），点击“共享”→完成。
            - 高级设置（可选）：右键→属性→高级共享，勾选“共享此文件夹”，可修改共享名、设置用户权限。

        - 跨设备访问方法
            - PC2/PC3 访问：打开“此电脑”，地址栏输入 UNC 路径（\\192.168.1.11\share，推荐用 IP 地址），回车即可访问（默认用户名 Administrator，密码 310030）。
            - 手机/平板访问：
                - 安卓：用 ES 文件浏览器→局域网→新建服务器，输入 PC1 IP+共享名，填写用户名密码。
                - 苹果（iPhone/iPad）：文件→连接服务器，输入 PC1 IP，选择注册用户，输入用户名密码。
                - Mac：访达→前往→连接服务器，输入 smb://192.168.1.11，填写 Windows 账户名和密码。

    - 子实验 2：远程桌面连接（跨设备控制）
        - 被访问端设置（以 PC2 为例）
            - 右键“此电脑”→属性→远程设置，在“远程桌面”区域勾选“允许远程连接到此计算机”。
            - 点击“选择用户”，确认 Administrator 已在授权列表（默认已包含，无需重复添加）。

        - 访问端操作（PC1/PC3 及手机）
            - PC 端：开始菜单→Windows 附件→远程桌面连接，输入 PC2 IP（192.168.1.22），点击“连接”，输入用户名（Administrator）和密码（310030）。
            - 高级设置：在“本地资源”→详细信息，勾选“驱动器”和“剪贴板”，可实现本地与远程设备的文件/数据传输。
            - 手机端：安装 Microsoft 远程桌面 App（RD 客户端），添加 PC2 IP，输入用户名密码即可连接。

    - 子实验 3：流媒体服务配置（音视频点播）
        - 服务端配置（以 PC3 为例）
            - 打开 Windows 管理工具→Internet Information Services (IIS)管理器。
            - 展开服务器→网站→Default Web Site（确保已启动），点击“媒体服务”→“Web 播放列表”。
            - 点击“添加播放列表”，设置文件名（如 left456）和标题，点击“添加”选择媒体文件（路径如 C:\wmroot\*.mp4）。
            - 保存播放列表，复制 URL（如 http://EBASE-R01:80/left456.isx），访问时需将计算机名改为 PC3 IP（192.168.1.33/left456.isx）。

        - 客户端访问
            - PC 端：打开 Windows Media Player→文件→打开 URL，输入修改后的播放列表地址；或用 PotPlayer→打开链接，输入地址。
            - 手机端：
                - 安卓：VLC→更多→串流→新建串流，输入 URL。
                - 苹果：VLC→网络→打开网络串流，输入 URL。
            - 故障排除：
                - 无法播放时，检查播放器“工具→选项→播放机”，勾选“连接到 Internet”。
                - 播放列表报错时，右键媒体文件夹→属性→安全，添加 Users 用户组，赋予“读取和执行”“列出文件夹内容”“读取”权限。

    - 实验结果检查要点
        - PC2/3 能访问 PC1 的共享文件夹，PC1 手机可访问。
        - PC1/3 能通过远程桌面控制 PC2，PC2 手机可访问。
        - 所有终端能通过播放器打开 PC3 的流媒体节目。

- 虚拟 WiFi 组网共享上网实验（模块二）

    - 核心目标
        - 以 PC1 为“主机”搭建虚拟 WiFi，PC2/3 及手机作为“副机”，通过主机共享的网络访问校网或外网。

    - 核心原理
        - 利用 Connectify Hotspot 软件将 PC1 虚拟为无线路由器，共享其已有的网络连接（校网/外网），副机通过无线连接虚拟 WiFi 实现上网。

    - 实验前提
        - PC1 需先接入网络：连接 wlan/5G（上校网）或 ZJUWLAN（登录 VPN 上外网）。
        - 仅一台 PC 可启动 Connectify Hotspot，启动前需关闭其他主机的该软件及托盘进程。

    - 详细配置步骤
        - 主机配置（PC1）
            - 情况一：PC1 连接 wlan/5G（共享校网）
                - 网络设置：无线网卡 IP 自动获取，确保能访问校网；打开 ZJU_VPN 客户端登录，验证外网访问（可选）。
                - 启动 Connectify Hotspot：
                    - 能激活：弹出激活窗口→点击“激活”→“继续”，退出 ZJU_VPN，配置参数：
                        - 要共享的 Internet：选择 wlan/5G。
                        - 网络访问：路由。
                        - 热点名称：自定义（如 Connectify-left456），密码≥8 位（如 12345678）。
                        - 点击“启动热点”，虚拟网卡自动获取 IP 192.168.137.1。
                    - 不能激活：关闭激活窗口，退出 ZJU_VPN，手动选择共享网络（wlan/5G），其余参数同上（Lite 版有广告，功能不影响实验）。

            - 情况二：PC1 连接 ZJUWLAN（共享外网）
                - 网络设置：打开浏览器登录校网认证页（net/zju.edu.cn），输入 VPN 账号登录，确保能访问外网。
                - 启动 Connectify Hotspot：
                    - 能激活：激活后保持校网登录状态，配置参数（共享网络选择 ZJUWLAN，其余同上）。
                    - 不能激活：关闭激活窗口，手动选择 ZJUWLAN 作为共享网络，其余参数同上。

        - 副机配置（PC2/3 及手机）
            - 网络设置：无线网卡 IP 自动获取，搜索 PC1 创建的虚拟 WiFi 热点（如 Connectify-left456）。
            - 连接热点：输入密码（如 12345678），连接成功后，副机 IP 会自动分配为 192.168.137.x 网段。
            - 验证上网：打开浏览器访问浙大官网（https://www.zju.edu.cn），校网共享可访问校内资源，外网共享可访问校外资源。

    - 故障排除
        - 主机无法启动热点：检查无线网卡是否已连接网络；在设备管理器→显示隐藏设备，启用“Microsoft Wi-Fi Direct Virtual Adapter”。
        - 副机找不到热点：关闭再打开副机无线网络功能，或刷新网络列表；检查主机热点是否已启动。
        - 连接后无法上网：确认主机已正常访问校网/外网；副机 IP 是否为 192.168.137.x 网段，重启热点重试。

- 补充说明与安全提示

    - 共享方式对比
        - 文件夹共享：基于 SMB 协议，支持加密传输，仅内网通信，数据更安全，速度快。
        - 远程桌面连接：支持设备控制和文件传输，可通过 SSL 加密，建议修改默认 3389 端口或打补丁提升安全性。
        - 流媒体服务：无本地文件残留，边传边播，适合音视频共享。

    - 终端兼容性
        - 鸿蒙系统：安卓内核（4 及以下）直接安装 App，纯血鸿蒙（5 及以上）通过“卓易通”安装。
        - 不支持的播放器：MXPlayer、KMPlayer 不支持.isx 格式流媒体播放列表，推荐 VLC 或 OPlayer。