## 知识点

### 二次型

- 定义及其矩阵表达式

	$f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$，其中 $\boldsymbol A=\boldsymbol A^T$（若不是，需要 $\boldsymbol A\gets\dfrac 1 2 (\boldsymbol A+\boldsymbol A^T)$），$\boldsymbol A$ 的秩称为二次型 $f$ 的秩

- 线性替换：$\boldsymbol x=\boldsymbol C\boldsymbol y$

	$f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x\xlongequal{\boldsymbol x=\boldsymbol C\boldsymbol y}(\boldsymbol C\boldsymbol y)^T\boldsymbol A(\boldsymbol C\boldsymbol y)=\boldsymbol y^T(\boldsymbol C^T\boldsymbol A\boldsymbol C)\boldsymbol y\xlongequal{\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol B}\boldsymbol y^T\boldsymbol B\boldsymbol y=g(\boldsymbol y)$
	
	若 $\boldsymbol C$ 可逆，则 $\boldsymbol A$ 与 $\boldsymbol B$ 合同，$f(\boldsymbol x)$ 与 $g(\boldsymbol y)$ 为合同二次型，称为非退化线性替换。
	
	若 $\boldsymbol C$ 为正交矩阵，称为正交线性替换。

### 标准形与规范形

- 标准形：只有平方项、没有交叉项的二次型，$g(\boldsymbol y)=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y$。

    合同标准形：与 $f(\boldsymbol x)$ 合同的标准形 $g(\boldsymbol y)$。

    求法：任意 $\mathbb P^{n\times n}$ 中的对称矩阵必与某个 $\mathbb P^{n\times n}$ 中的对角矩阵合同。写出 $\boldsymbol A$，求出 $\boldsymbol Q^T\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda$，令 $\boldsymbol x=\boldsymbol Q\boldsymbol y$。（可以用配方法。特别地，如果 $\mathbb P=\mathbb R$，还可以用实对称矩阵的正交相似对角化或成对初等变换法）
    
    - 配方法：

        1. 若含有平方项，选一个含平方项的变量（如 $x_1$），将所有含 $x_1$ 的项配方，消去所有含 $x_1$ 的交叉项，重复此操作；
        2. 若不含平方项，选一个交叉项（如 $x_1x_2$），作非退化线性替换 $\begin{cases}x_1=y_1+y_2\\x_2=y_1-y_2\end{cases}$ 转化为含平方项的形式。

        矩阵语言：对于对称矩阵 $\boldsymbol A\in\mathbb P^{n\times n}$，必存在可逆矩阵 $\boldsymbol C\in\mathbb P^{n\times n}$，使得 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol \Lambda$，其中 $\boldsymbol \Lambda$ 是对角矩阵。这里的 $\boldsymbol C$ 不一定是特征向量组成的，$\boldsymbol \Lambda$ 也不一定是特征值。

	- 成对初等变换法：考虑 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol E_k^T\cdots\boldsymbol E_2^T\boldsymbol E_1^T\boldsymbol A\boldsymbol E_1\boldsymbol E_2\cdots\boldsymbol E_k=\boldsymbol \Lambda$ 时，$\boldsymbol \Lambda\boldsymbol E_k^T\cdots\boldsymbol E_2^T\boldsymbol E_1^T\boldsymbol E=\boldsymbol C^T$。$\boldsymbol A,\boldsymbol E$ 一起做行变换，只对 $\boldsymbol A$ 做列变换，$(\boldsymbol A,\boldsymbol E)\to(\boldsymbol \Lambda,\boldsymbol C^T)$
	
		$\boldsymbol E_{ij}=\boldsymbol E_{ij}^T$（一起 $R_{ij}$，单独 $C_{ij}$），$\boldsymbol E_i(k)=\boldsymbol E_i(k)^T$（一起 $kR_i$，单独 $kC_i$），$\boldsymbol E_{ji}(k)=\boldsymbol E_{ij}(k)^T$（一起 $R_j+kR_i$，单独 $C_j+kC_i$）

- 实规范形：系数 $\in\{1,-1,0\}$ 的标准形。

	复规范形：系数 $\in\{1,0\}$ 的标准形。

	合同规范形：与 $f(\boldsymbol x)$ 合同的规范形。

- 实二次型的惯性定理：实二次型的所有合同标准形的正平方项个数 $p$、负平方项的个数 $q$ 相同。
  
	若二次型的秩为 $r$，则 $q=r-p$。$p$、$q=r-p$、$p-q=2p-r$ 分别称为该二次型 $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$（或该实对称矩阵 $\boldsymbol A$）的正惯性指数、负惯性指数、符号差。
	
	求法：由于 $\text{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)$ 是一个标准形，故 $p=\sum_{i=1}^n[\lambda_i>0]$，$q=\sum_{i=1}^n[\lambda_i<0]$。也可以配方法化标准形。
	
	（任意 $\mathbb P^{n\times n}$ 中的对称矩阵必与 $\mathbb P^{n\times n}$ 中的正负惯性指数与之相同的对角矩阵合同）
  
	非退化线性替换不改变正、负惯性指数。

### 合同

- 自反性，对称性，传递性
- 若 $\boldsymbol A$ 与 $\boldsymbol B$ 合同，则 $r(\boldsymbol A)=r(\boldsymbol B)$，$\boldsymbol A^T=\boldsymbol A\Leftrightarrow \boldsymbol B^T=\boldsymbol B$

- 对于同阶实对称矩阵 $\boldsymbol A,\boldsymbol B$

	$\boldsymbol A,\boldsymbol B$ 合同
	
	$\Leftrightarrow$ 存在可逆矩阵 $\boldsymbol C$，使得 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol B$（定义）
	
	$\Leftrightarrow p_{\boldsymbol A}=p_{\boldsymbol B},q_{\boldsymbol A}=q_{\boldsymbol B}$
	
	$\Leftrightarrow \boldsymbol A,\boldsymbol B$ 的正、负特征值个数分别对应相同
	
	$\Leftrightarrow \exists \boldsymbol C$，$\boldsymbol A$ 合同于 $\boldsymbol C$，$\boldsymbol C$ 合同于 $\boldsymbol B$

- 实对称矩阵 $\boldsymbol A\sim\boldsymbol B\Rightarrow \boldsymbol A$ 与 $\boldsymbol B$ 合同

- 已知 $\boldsymbol A,\boldsymbol \Lambda$（$\boldsymbol \Lambda$ 是对角矩阵），求可逆矩阵 $\boldsymbol C$，使得 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol \Lambda$。

- 已知 $\boldsymbol A,\boldsymbol B$（$\boldsymbol B$ 不是对角矩阵），求可逆矩阵 $\boldsymbol C$，使得 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol B$。

	

### 几何应用

| $\lambda_1、\lambda_2、\lambda_3$ 的符号 | $3$ 正       | $2$ 正 $1$ 负    | $1$ 正 $2$ 负    | $2$ 正 $1$ 零    | $1$ 正 $1$ 负 $1$ 零 |
|------------------------------------------|-----------|-----------|-----------|-----------|-----------|
| $f(x_1,x_2,x_3)=1$ 对应的曲面           | 椭球面    | 单叶双曲面| 双叶双曲面| 椭圆柱面  | 双曲柱面  |


### 实二次型的正定性

- 实对称矩阵 $\boldsymbol A$ 正定

	$\Leftrightarrow$ 实二次型 $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 正定
	
	$\Leftrightarrow$ $\forall \boldsymbol x\neq \boldsymbol 0,\boldsymbol x\in\mathbb P^n$，有 $\boldsymbol x^T\boldsymbol A\boldsymbol x>0$（定义）
	
	$\Leftrightarrow$ $f$ 的正惯性指数 $p=n$ $\Leftrightarrow$ $\boldsymbol A$ 的所有特征值均 $>0$ $\Leftrightarrow$ $\boldsymbol A$ 与 $\boldsymbol E$ 合同 $\Leftrightarrow$ 存在可逆实矩阵 $\boldsymbol B$ 使得 $\boldsymbol A=\boldsymbol B^T\boldsymbol B$
	
	$\Leftrightarrow$ $\boldsymbol A$ 的所有顺序主子式均 $>0$

- $\boldsymbol A$ 正定 $\Rightarrow$ $\boldsymbol A^{-1}$，$\boldsymbol A^*$，$\boldsymbol A^k$（$k$ 为正整数），$k\boldsymbol A$（$k>0$），$\boldsymbol C^T\boldsymbol A\boldsymbol C$（$\boldsymbol C$ 可逆）均正定

	若 $\boldsymbol A,\boldsymbol B$ 正定，则 $\boldsymbol A+\boldsymbol B$ 正定，$\begin{pmatrix}\boldsymbol A&\boldsymbol O\\\boldsymbol O&\boldsymbol B\end{pmatrix}$ 正定
	
	若 $\boldsymbol A,\boldsymbol B$ 正定，则 $\boldsymbol A\boldsymbol B$ 正定 $\Leftrightarrow$ $\boldsymbol A\boldsymbol B=\boldsymbol B\boldsymbol A$
	
	若 $\boldsymbol A$ 正定且是正交矩阵，则 $\boldsymbol A=\boldsymbol E$

- $\boldsymbol A$ 正定 $\Leftrightarrow$ $\boldsymbol A^T$ 正定，$\boldsymbol A$ 正定 $\Leftrightarrow \boldsymbol A^{-1}$ 正定，$\boldsymbol A$ 正定 $\Rightarrow$ $\boldsymbol A^*$ 正定

	（先证对称，再证明 $\lambda>0$）

- 实对称矩阵 $\boldsymbol A$ 负定 $\Leftrightarrow$ $\boldsymbol A$ 的 $k$ 阶顺序主子式的符号与 $(-1)^k$ 的符号一致

- 实对称矩阵 $\boldsymbol A$ 半正定

	$\Leftrightarrow$ 实二次型 $f=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 半正定
	
	$\Leftrightarrow$ $\forall \boldsymbol x\neq \boldsymbol 0,\boldsymbol x\in\mathbb P^n$，有 $\boldsymbol x^T\boldsymbol A\boldsymbol x\geq 0$（定义）
	
	$\Leftrightarrow$ $f$ 的正惯性指数 $p=r$ $\Leftrightarrow$ $f$ 的负惯性指数 $q=0$ $\Leftrightarrow$ $\boldsymbol A$ 的所有特征值均 $\geq 0$ $\Leftrightarrow$ $\boldsymbol A$ 与 $\begin{pmatrix}\boldsymbol E_r&\boldsymbol O\\\boldsymbol O&\boldsymbol O\end{pmatrix}$ 合同 $\Leftrightarrow$ 存在实矩阵 $\boldsymbol B$ 使得 $\boldsymbol A=\boldsymbol B^T\boldsymbol B$
	
	$\Leftrightarrow$ $\boldsymbol A$ 的所有主子式 $\geq 0$

- 实对称矩阵 $\boldsymbol A$ 半负定 $\Leftrightarrow$ $\boldsymbol A$ 的所有 $k$ 阶主子式的值为 $0$ 或其符号与 $(-1)^k$ 的符号一致

## 题目

- 正交替换下 $\|\boldsymbol x\|=\|\boldsymbol y\|$

- 最值问题：$\lambda_{\min}\boldsymbol x^T\boldsymbol x\leq f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x\leq \lambda_{\max}\boldsymbol x^T\boldsymbol x$