## 知识点

### 矩阵的加减法、数乘、乘法和转置

- 矩阵的加减和数乘统称为矩阵的线性运算，满足交换律、结合律、分配律、数和矩阵相乘的结合律。

	??? warning "注意"
	
		- $|kA|=k^n |A|\neq k|A|\,(n\geq 2,\,k\neq 0,1)$
		
		- 一般地，$|A+B|\neq |A|+|B|$

- 矩阵的乘法：若矩阵 $A$ 的列数等于矩阵 $B$ 的行数，则 $A,B$ 可以相乘。矩阵乘法满足结合律、分配律、数乘与矩阵结合的结合律。$C_{ij}=(\alpha_i^T,\beta_j)$。

	??? warning "注意"

    	- 矩阵的乘法一般情况下不满足交换律，即 $AB\neq BA$。故一般地，$(A\pm B)^2\neq A^2\pm 2AB+B^2$，$(A+B)(A-B)\neq A^2-B^2$，$(AB)^k\neq A^kB^k$
    	  
    		但任意 $n$ 阶矩阵 $A$ 与 $n$ 阶单位矩阵 $E$ 可交换，故总有 $A^2-E=(A-E)(A+E)$，$(A+\lambda E)^n=\sum_{i=0}^n C_n^i A^i(\lambda E)^{n-i}=\sum_{i=0}^n C_n^i \lambda^{n-i}A^i$。
    	
    		（当且仅当矩阵乘积可交换时，我们学过的某些代数公式才可扩展到矩阵的情况）
    	  
    	- $AB=O\not\Rightarrow A=O$ 或 $B=O$
    	- $AB=AC\Rightarrow A(B-C)=O\not\Rightarrow A=O$ 或 $B=C$

	若存在 $A\neq O,B\neq O$ 满足 $AB=O$，则称 $A$ 为 **左零因子**，$B$ 为 **右零因子**。
	
	方阵乘积的行列式：对于 $n$ 阶方阵 $A,B$，$|AB|=|A||B|$。

- 矩阵的转置：$(A^T)^T=A$，$(kA)^T=kA^T$，$(A+B)^T=A^T+B^T$，$(AB)^T=B^TA^T$，$r(A)=r(A^T)$。若 $A$ 为方阵，$|A|=|A^T|$

- 矩阵的幂：方阵才有幂。

	若 $f(x)=a_0+a_1x+\cdots+a_mx^m$，则 $f(A)=a_0E+a_1A+\cdots+a_mA^m$。

	求 $A^n$ 的基本思路：

    1. 若 $A$ 是方阵，$r(A)=1$：$A^n=[\text{tr}(A)]^{n-1}A$
  
    	??? note "证明"
    		利用 $A_{1\times n}B_{n\times 1}=C_{1 \times 1}$，$A_{n\times 1}\times B_{1\times n}=C_{n\times n}$：
	  	
	  		设 $\alpha=[a_1,a_2,\cdots,a_k]^T$，$\beta=[b_1,b_2,\cdots,b_k]^T$，$A=\alpha\beta^T$，则 $A^n=(\alpha\beta^T)^n=\alpha(\beta ^T\alpha)^{n-1}\beta^T$【将一列乘一行转化成一行乘一列。$\beta^T\alpha$ 是一个数】$=(\sum_{i=1}^k a_ib_i)^{n-1}A$。
	  		
	  		而若 $r(A)=1$，$A$ 一定可以拆成上面那种一列乘一行的形式。因为若 $A_{ij}=a_ib_j$，则 $A=[a_1,a_2,\cdots,a_k]^T[b_1,b_2,\cdots,b_k]$。$A^n=(\sum_{i=1}^k a_ib_i)^{n-1}A$【即主对角线元素之和的 $n-1$ 次方乘以 $A$】。
  
    2. 试算 $A^2,A^3$ 等，归纳出结果
  
    	残爪型
  
    3. 若 $A=B+C$ 且 $BC=CB$，则可将 $A^n=(B+C)^n$ 二项式展开
  
    	??? example "例题"
    		$A = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1 \end{pmatrix}$，求 $A^n$。
    	
    	      $A =\begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix} + \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{pmatrix} = E + B$
    	
    	      当 $k\geq 3$ 时，$B^k=O$

- 几种重要矩阵：零矩阵，单位矩阵，数量矩阵，对角矩阵，上（下）三角矩阵，对称矩阵，反对称矩阵。

	??? info "方阵与特殊矩阵的乘法"
  
        对于 $A = (a_{ij})_{n \times n}$：
        
        $$
        \text{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n)\times  A = \begin{pmatrix} \lambda_1 a_{11} & \lambda_1 a_{12} & \cdots & \lambda_1 a_{1n} \\ \lambda_2 a_{21} & \lambda_2 a_{22} & \cdots & \lambda_2 a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda_n a_{n1} & \lambda_n a_{n2} & \cdots & \lambda_n a_{nn} \end{pmatrix}\\
        A \times \text{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n) = \begin{pmatrix} \lambda_1 a_{11} & \lambda_2 a_{12} & \cdots & \lambda_n a_{1n} \\ \lambda_1 a_{21} & \lambda_2 a_{22} & \cdots & \lambda_n a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda_1 a_{n1} & \lambda_2 a_{n2} & \cdots & \lambda_n a_{nn} \end{pmatrix}\\
        \text{diag}(\lambda, \lambda, \cdots, \lambda)\times A=A\times \text{diag}(\lambda, \lambda, \cdots, \lambda)=\begin{pmatrix} \lambda a_{11} & \lambda a_{12} & \cdots & \lambda a_{1n} \\ \lambda a_{21} & \lambda a_{22} & \cdots & \lambda a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda a_{n1} & \lambda a_{n2} & \cdots & \lambda a_{nn} \end{pmatrix} = \lambda A
        $$

- 方阵的迹：$\text{tr}(A_{n\times n})=\sum_{i=1}^n a_{ii}$。$\text{tr}(A\pm B)=\text{tr}(A)\pm \text{tr}(B)$，$\text{tr}(kA)=k\text{tr}(A)$，$\text{tr}(AB)=\text{tr}(BA)$
	
	虽然一般 $AB\neq BA$，但是 $|AB|=|BA|$、$\text{tr}(AB)=\text{tr}(BA)$（$A,B$ 均为方阵）。

### 矩阵求逆

- 逆矩阵的定义

	对于 $n$ 阶方阵 $A$，若存在 $n$ 阶方阵 $B$ 使得 $AB=BA=E$，则称 $A$ 可逆（非退化/非奇异），且 $B$ 是 $A$ 的逆矩阵。否则，称 $A$ 不可逆（退化/奇异）。

	1. 逆矩阵是相互的。
	
	2. 逆矩阵是唯一的。
	
        ??? note "证明"

            反证。若 $B\neq C$，$AB=BA=E$ 且 $AC=CA=E$，则 $B=BE=B(AC)=(BA)C=EC=C$，矛盾。
     
    3. $A_{n\times n}$ 可逆 $\Leftrightarrow$ $|A|\neq 0$。当 $|A|\neq 0$ 时，$A$ 可逆，且 $A^{-1}=\frac{A^*}{|A|}$。其中 $A^*$ 为伴随矩阵，记作 $A^{*}=\begin{pmatrix}A_{1,1}&A_{2,1}&\cdots&A_{n,1}\\A_{1,2}&A_{2,2}&\cdots&A_{n,2}\\\vdots&\vdots&\ddots&\vdots\\A_{1,n}&A_{2,n}&\cdots&A_{n,n}\end{pmatrix}$（将 $a_{i,j}$ 换成 $A_{i,j}$ 再转置）。

		??? note "证明"
			
			???+ info "引理"
				$AA^*=A^*A=|A|E$
		
				证明：
	
				$\sum_{k=1}^n a_{ik}A^*_{kj}=\sum_{k=1}^n a_{ik}A_{jk}=|A|[i=j]$
	
				$\sum_{k=1}^n A^*_{ik}a_{kj}=\sum_{k=1}^n A_{ki}a_{kj}=|A|[i=j]$
			
			$\Rightarrow$：$AA^{-1}=E$，则 $|A||A^{-1}|=|E|=1$，即 $|A|\neq 0$。
			
			$\Leftrightarrow$：$AA^*=A^*A=|A|E$，由于 $|A|\neq 0$，则 $A\cdot \dfrac{A^*}{|A|}=\dfrac{A^*}{|A|}A=E$，可知 $A$ 可逆，$A^{-1}=\dfrac{A^*}{|A|}$。
		
	4. 对于 $A_{n\times n},B_{n\times n}$，$AB=E$ 或 $BA=E$ $\Leftrightarrow$ $A^{-1}=B$ 且 $B^{-1}=A$。
	
		??? note "证明"
			- $\Rightarrow$：
			
                下证 $AB=E\Rightarrow A^{-1}=B,B^{-1}=A$。
    
                $AB=E\Rightarrow |AB|=|E|\Rightarrow |A|\neq 0,|B|\neq 0\Rightarrow \exists A^{-1},B^{-1}$
    
                $A^{-1}=A^{-1}(AB)=(A^{-1}A)B=B$
    
                $B^{-1}=(AB)B^{-1}=A(BB^{-1})=A$
    
		    - $\Leftarrow$：显然
		
		也就是说，$AB=E\Leftrightarrow BA=E\Leftrightarrow A,B$ 互为逆矩阵。

- 逆矩阵的性质与重要公式

	设 $A,B$ 是同阶可逆矩阵，则：
	
	- $(A^{-1})^{-1}=A$
	- 若 $k\neq 0$，则 $(kA)^{-1}=\frac 1 k A^{-1}$
	- $AB$ 也可逆，且 $(AB)^{-1}=B^{-1}A^{-1}$
	- $A^T$ 也可逆，且 $(A^T)^{-1}=(A^{-1})^T$
	- $|A^{-1}|=|A|^{-1}$

	??? note "证明"
		证 $A^{-1}=B$，只需证 $AB=E$。显然：
		
		- $A^{-1}A=E$
		- $(kA)(\dfrac 1 k A^{-1})=E$
		- $|AB|=|A||B|\neq 0\Rightarrow$ $AB$ 可逆。$(AB)(B^{-1}A^{-1})=A(BB^{-1})A^{-1}=E$
		- $A^T(A^{-1})^T=(A^{-1}A)^T=E$
		
		最后一条利用 $|AB|=|A||B|$ 证。
		
		- $|A^{-1}|=\dfrac{|E|}{|A|}=\dfrac{1}{|A|}$
	
	???+ warning "注意"
		$A+B$ 不一定可逆，且 $(A+B)^{-1}\neq A^{-1}+B^{-1}$。

- 求逆矩阵
    - 用定义求逆矩阵

        1. 根据定义，若能找到矩阵 $B$ 使得 $AB = E$，则 $A$ 可逆，且 $A^{-1} = B$。

            ??? example "例题"
                设 $A,B$ 均是 $n$ 阶矩阵，且 $AB=A+B$，则：

                A. $A-E$ 为可逆矩阵；
                B. $A+E$ 为可逆矩阵；
                C. $A-2E$ 为可逆矩阵；
                D. $B+E$ 为可逆矩阵
    
                ??? note "解答"
                    $AB-A-B=0$
    
                    $A(B-E)-(B-E)=E$
    
                    $(A-E)(B-E)=E$
    
                    $A-E$ 与 $B-E$ 互为逆矩阵
    
                    答案：A

        2. 分解为可逆矩阵的乘积：若 $A = BC$ 且 $B,C$ 均可逆，则 $A$ 可逆【两个可逆矩阵的乘积仍可逆】，且 $A^{-1} = (BC)^{-1} = C^{-1}B^{-1}$。

            ??? example "例题"
                设 $A,B$ 是同阶可逆方阵，且 $A^{-1}+B^{-1}$ 可逆，证明 $A+B$ 是可逆矩阵，并求 $(A+B)^{-1}$。

                ??? note "解答"
                    $A+B=A(E+A^{-1}B)=A(B^{-1}+A^{-1})B$ 可逆
    
                    $(A+B)^{-1}=B^{-1}(B^{-1}+A^{-1})^{-1}A^{-1}$

        3. 简单分块矩阵的逆：若 $A,B$ 均为可逆方阵，则

            $\begin{bmatrix} A & O \\ O & B \end{bmatrix}^{-1} = \begin{bmatrix} A^{-1} & O \\ O & B^{-1} \end{bmatrix}$，$\begin{bmatrix} O & A \\ B & O \end{bmatrix}^{-1} = \begin{bmatrix} O & B^{-1} \\ A^{-1} & O \end{bmatrix}$

    - 用伴随矩阵求逆矩阵：若 $|A|\neq 0$，则 $A$ 可逆，且 $A^{-1}=\dfrac 1 {|A|}A^*$
    
    	??? example "例题"
    		已知 $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$，写出 $A$ 可逆的一个充要条件，当 $A$ 可逆时，求 $A^{-1}$。
    		
    		??? note "解答"
    		
      	      ① 求 $|A|=ad-bc$。$A$ 可逆 $\Leftrightarrow$ $ad\neq bc$
	
      	      ② 求 $A^*=\begin{pmatrix}A_{11}&A_{21}\\A_{12}&A_{22}\end{pmatrix}=\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$
	
      	      ???+ tip
      	          二阶矩阵 $A\to A^*$：主对调，副变号
	
      	      ③ 则 $A^{-1}=\dfrac{A^*}{|A|}=\dfrac{1}{ad-bc}\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$

- 伴随矩阵的性质与重要公式

	- 对任意 $n$ 阶方阵 $A$，都有伴随矩阵 $A^*$，且 $AA^*=A^*A=|A|E$，$|A^*|=|A|^{n-1}$。
	
        ??? note "证明"
            若 $|A|\neq 0$：$|A^*|=||A|A^{-1}|=|A|^n\cdot |A|^{-1}=|A|^{n-1}$
    
            若 $|A|=0$：反证。假设 $|A^*|\neq 0$，则 $(A^{*})^{-1}$ 存在，又 $AA^*=|A|E=O\Rightarrow A A^*(A^{*})^{-1}=O\cdot (A^*)^{-1}\Rightarrow A=O\Rightarrow A^*=O$，与 $|A^*|\neq 0$ 矛盾。故 $|A^{*}|=0$。
	
	- 当 $|A|\neq 0$ 时，有：

        - $A^*=|A|A^{-1}$，$A^{-1}=\frac{A^*}{|A|}$，$A=|A|(A^*)^{-1}$
    
        - $(kA)^*=k^{n-1}A^*$，$(A^T)^*=(A^*)^T$，$(A^{-1})^*=(A^*)^{-1}=\frac A {|A|}$，$(A^*)^*=|A|^{n-2}A$，$(AB)^*=B^*A^*$
    
        ??? note "证明"
            - 利用 $AA^*=|A|E$：
    
                $A^{-1}AA^*=A^{-1}|A|E\Rightarrow A^*=A^{-1}|A|$，$A^{-1}=\dfrac{1}{|A|}A^*$
    
                $AA^*(A^*)^{-1}=|A|E(A^*)^{-1}\Rightarrow |A|(A^*)^{-1}$
    
            - 利用 $A^*=|A|A^{-1}$
    
                $(kA)^*=|kA|(kA)^{-1}\Rightarrow (kA)^*=k^n|A|\cdot \dfrac 1 k A^{-1}=k^{n-1}|A|A^{-1}=k^{n-1}A^*$
    
                $(A^T)^*=|A^T|(A^T)^{-1}=|A|(A^{-1})^T=(|A|A^{-1})^T=(A^*)^T$
    
                $(A^{-1})^*=|A^{-1}|(A^{-1})^{-1}=(|A|A^{-1})^{-1}=(A^*)^{-1}$
    
                $(A^*)^*=|A^*|(A^*)^{-1}=|A|^{n-1}(|A|A^{-1})^{-1}=|A|^{n-2}A$
    
                $(AB)^*=|AB|(AB)^{-1}=|B|B^{-1}|A|A^{-1}=B^*A^*$
    
        ???+ warning "注意"
            $(A+B)^*\neq A^*+B^*$
		

- 伴随矩阵的其他性质

	- $A_{n\times n}\,(n\geq 2)$，则 $r(A^*)=\begin{cases}n,&r(A)=n\\1,&r(A)=n-1\\0,&r(A)<n-1\end{cases}$
	
		??? note "证明"
			- 当 $r(A)=n$ 时：
				
				$r(A)=n\Rightarrow |A|\neq 0\Rightarrow |A^*|=|A|^{n-1}\neq 0\Rightarrow r(A^*)=n$
			
			- 当 $r(A)=n-1$ 时：
				
				$A$ 中至少有一个 $n-1$ 阶子式不为 $0$，所以 $A^*\neq O$，即 $r(A^*)\geq 1$。
				
				又 $|A|=0$，所以 $AA^*=|A|E=O$。
				
				根据矩阵秩的性质（若 $AB=O$，则 $r(A)+r(B)\leq n$，其中 $n$ 为 $A$ 的列数，同时也是 $B$ 的行数），则 $r(A)+r(A^*)\leq n\Rightarrow n-1+r(A^*)\leq n\Rightarrow r(A^*)\leq 1$。
				
				故 $r(A^*)=1$。
			
			- 当 $r(A)<n-1$ 时：
			
				$A$ 中所有 $n-1$ 阶子式都为 $0$，所以 $A^*=O$，从而 $r(A^*)=0$。

### 分块矩阵

- 分块矩阵的积

	前提条件：1. 分块前可以乘（$A$ 列数等于 $B$ 行数）；2. 分块完可以乘（$A$ 列分块方式与 $B$ 行分块方式一致）

- 分块矩阵的转置：块之间转置，块内也转置。

## 公式总结

- $|kA|=k^n|A|$

	$(kA)^T=kA^T$
	
	$(kA)^{-1}=\frac 1 k A^{-1}$
	
	$(kA)^*=k^{n-1}A^*$

- $|A+B|\neq |A|+|B|$

	$(A+B)^T=A^T+B^T$
	
	$(A+B)^{-1}\neq A^{-1}+B^{-1}$
	
	$(A+B)^*\neq A^*+B^*$

- $|AB|=|A||B|=|B||A|$

	$(AB)^T=B^TA^T$
	
	$(AB)^{-1}=B^{-1}A^{-1}$
	
	$(AB)^*=B^*A^*$

- $(A^T)^{-1}=(A^{-1})^T$

	$(A^*)^{-1}=(A^{-1})^*$
	
	$(A^T)^*=(A^*)^T$