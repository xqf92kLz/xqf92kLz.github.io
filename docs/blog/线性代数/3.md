## 知识点

??? info "矩阵的加减法、数乘、乘法和转置"

    - 矩阵的加减和数乘统称为矩阵的线性运算，满足交换律、结合律、分配律、数和矩阵相乘的结合律。
    
        ??? warning "注意"
    
            - $|kA|=k^n |A|\neq k|A|\,(n\geq 2,\,k\neq 0,1)$
    
            - 一般地，$|A+B|\neq |A|+|B|$
    
    - 矩阵的乘法：若矩阵 $A$ 的列数等于矩阵 $B$ 的行数，则 $A,B$ 可以相乘。矩阵乘法满足结合律、分配律、数乘与矩阵结合的结合律。$C_{ij}=(\alpha_i^T,\beta_j)$。
    
        ??? warning "注意"
    
            - 矩阵的乘法一般情况下不满足交换律，即 $AB\neq BA$。故一般地，$(A\pm B)^2\neq A^2\pm 2AB+B^2$，$(A+B)(A-B)\neq A^2-B^2$，$(AB)^k\neq A^kB^k$
    
                但任意 $n$ 阶矩阵 $A$ 与 $n$ 阶单位矩阵 $E$ 可交换，故总有 $A^2-E=(A-E)(A+E)$，$(A+\lambda E)^n=\sum_{i=0}^n C_n^i A^i(\lambda E)^{n-i}=\sum_{i=0}^n C_n^i \lambda^{n-i}A^i$。
    
                （当且仅当矩阵乘积可交换时，我们学过的某些代数公式才可扩展到矩阵的情况）
    
            - $AB=O\not\Rightarrow A=O$ 或 $B=O$
            - $AB=AC\Rightarrow A(B-C)=O\not\Rightarrow A=O$ 或 $B=C$
    
        若存在 $A\neq O,B\neq O$ 满足 $AB=O$，则称 $A$ 为 **左零因子**，$B$ 为 **右零因子**。
    
        方阵乘积的行列式：对于 $n$ 阶方阵 $A,B$，$|AB|=|A||B|$。
    
    - 矩阵的转置：$(A^T)^T=A$，$(kA)^T=kA^T$，$(A+B)^T=A^T+B^T$，$(AB)^T=B^TA^T$，$r(A)=r(A^T)$。若 $A$ 为方阵，$|A|=|A^T|$
    
    - 矩阵的幂：方阵才有幂。
    
        若 $f(x)=a_0+a_1x+\cdots+a_mx^m$，则 $f(A)=a_0E+a_1A+\cdots+a_mA^m$。
    
    - 几种重要矩阵：零矩阵，单位矩阵，数量矩阵，对角矩阵，上（下）三角矩阵，对称矩阵，反对称矩阵。
    
        ??? info "方阵与特殊矩阵的乘法"
    
            对于 $A = (a_{ij})_{n \times n}$：
    
            $$
            \text{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n)\times  A = \begin{pmatrix} \lambda_1 a_{11} & \lambda_1 a_{12} & \cdots & \lambda_1 a_{1n} \\ \lambda_2 a_{21} & \lambda_2 a_{22} & \cdots & \lambda_2 a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda_n a_{n1} & \lambda_n a_{n2} & \cdots & \lambda_n a_{nn} \end{pmatrix}\\
            A \times \text{diag}(\lambda_1, \lambda_2, \cdots, \lambda_n) = \begin{pmatrix} \lambda_1 a_{11} & \lambda_2 a_{12} & \cdots & \lambda_n a_{1n} \\ \lambda_1 a_{21} & \lambda_2 a_{22} & \cdots & \lambda_n a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda_1 a_{n1} & \lambda_2 a_{n2} & \cdots & \lambda_n a_{nn} \end{pmatrix}\\
            \text{diag}(\lambda, \lambda, \cdots, \lambda)\times A=A\times \text{diag}(\lambda, \lambda, \cdots, \lambda)=\begin{pmatrix} \lambda a_{11} & \lambda a_{12} & \cdots & \lambda a_{1n} \\ \lambda a_{21} & \lambda a_{22} & \cdots & \lambda a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ \lambda a_{n1} & \lambda a_{n2} & \cdots & \lambda a_{nn} \end{pmatrix} = \lambda A
            $$

### 矩阵求逆


- 逆矩阵

    - 逆矩阵的定义

        对于 $n$ 阶方阵 $A$，若存在 $n$ 阶方阵 $B$ 使得 $AB=BA=E$，则称 $A$ 可逆（非退化/非奇异），且 $B$ 是 $A$ 的逆矩阵。否则，称 $A$ 不可逆（退化/奇异）。

        1. 逆矩阵是唯一的。

            ??? note "证明"

                反证。若 $B\neq C$，$AB=BA=E$ 且 $AC=CA=E$，则 $B=BE=B(AC)=(BA)C=EC=C$，矛盾。

        2. $A_{n\times n}$ 可逆 $\Leftrightarrow$ $|A|\neq 0$。当 $|A|\neq 0$ 时，$A$ 可逆，且 $A^{-1}=\frac{A^*}{|A|}$。

            ??? note "证明"

                ???+ info "引理"
                    $AA^*=A^*A=|A|E$
                
                    证明：
                
                    $\sum_{k=1}^n a_{ik}A^*_{kj}=\sum_{k=1}^n a_{ik}A_{jk}=|A|[i=j]$
                
                    $\sum_{k=1}^n A^*_{ik}a_{kj}=\sum_{k=1}^n A_{ki}a_{kj}=|A|[i=j]$
                
                $\Rightarrow$：$AA^{-1}=E$，则 $|A||A^{-1}|=|E|=1$，即 $|A|\neq 0$。
                
                $\Leftrightarrow$：$AA^*=A^*A=|A|E$，由于 $|A|\neq 0$，则 $A\cdot \dfrac{A^*}{|A|}=\dfrac{A^*}{|A|}A=E$，可知 $A$ 可逆，$A^{-1}=\dfrac{A^*}{|A|}$。

        3. 对于 $A_{n\times n},B_{n\times n}$，$AB=E$ 或 $BA=E$ $\Leftrightarrow$ $A^{-1}=B$ 且 $B^{-1}=A$。也就是说，$AB=E\Leftrightarrow BA=E\Leftrightarrow A,B$ 互为逆矩阵。

            ??? note "证明"
                - $\Rightarrow$：

                    下证 $AB=E\Rightarrow A^{-1}=B,B^{-1}=A$。
                
                    $AB=E\Rightarrow |AB|=|E|\Rightarrow |A|\neq 0,|B|\neq 0\Rightarrow \exists A^{-1},B^{-1}$
                
                    $A^{-1}=A^{-1}(AB)=(A^{-1}A)B=B$
                
                    $B^{-1}=(AB)B^{-1}=A(BB^{-1})=A$
                
                - $\Leftarrow$：显然

    - 逆矩阵的性质与重要公式

        设 $A,B$ 是同阶可逆矩阵，则：

        - $(A^{-1})^{-1}=A$
        - 若 $k\neq 0$，则 $(kA)^{-1}=\frac 1 k A^{-1}$
        - $AB$ 也可逆，且 $(AB)^{-1}=B^{-1}A^{-1}$
        - $A^T$ 也可逆，且 $(A^T)^{-1}=(A^{-1})^T$
        - $|A^{-1}|=|A|^{-1}$

        ??? note "证明"
            证 $A^{-1}=B$，只需证 $AB=E$。显然：

            - $A^{-1}A=E$
            - $(kA)(\dfrac 1 k A^{-1})=E$
            - $|AB|=|A||B|\neq 0\Rightarrow$ $AB$ 可逆。$(AB)(B^{-1}A^{-1})=A(BB^{-1})A^{-1}=E$
            - $A^T(A^{-1})^T=(A^{-1}A)^T=E$
            
            最后一条利用 $|AB|=|A||B|$ 证。
            
            - $|A^{-1}|=\dfrac{|E|}{|A|}=\dfrac{1}{|A|}$

        ???+ warning "注意"
            $A+B$ 不一定可逆，且 $(A+B)^{-1}\neq A^{-1}+B^{-1}$。

- 伴随矩阵

    - 伴随矩阵的定义

        $A^{*}=\begin{pmatrix}A_{1,1}&A_{2,1}&\cdots&A_{n,1}\\A_{1,2}&A_{2,2}&\cdots&A_{n,2}\\\vdots&\vdots&\ddots&\vdots\\A_{1,n}&A_{2,n}&\cdots&A_{n,n}\end{pmatrix}$（将 $a_{i,j}$ 换成 $A_{i,j}$ 再转置）。

    - 伴随矩阵的性质与重要公式

        - 对任意 $n$ 阶方阵 $A$，都有伴随矩阵 $A^*$，且 $AA^*=A^*A=|A|E$，$|A^*|=|A|^{n-1}$。

            ??? note "证明"
                若 $|A|\neq 0$：$|A^*|=||A|A^{-1}|=|A|^n\cdot |A|^{-1}=|A|^{n-1}$

                若 $|A|=0$：反证。假设 $|A^*|\neq 0$，则 $(A^{*})^{-1}$ 存在，又 $AA^*=|A|E=O\Rightarrow A A^*(A^{*})^{-1}=O\cdot (A^*)^{-1}\Rightarrow A=O\Rightarrow A^*=O$，与 $|A^*|\neq 0$ 矛盾。故 $|A^{*}|=0$。
                
                ???+ tip
                	$A$ 可逆 $\Leftrightarrow$ $A^*$ 可逆
                	
                	??? note "证明"
                	
                        - $\Rightarrow$：若 $A$ 可逆，可知 $|A|\neq 0$，又由 $AA^*=|A|E$，有 $\dfrac A {|A|}A^*=E$，即有 $A^*$ 可逆，且 $(A^*)^{-1}=\dfrac{A}{|A|}$。
                        - $\Leftarrow$：若 $A^*$ 可逆，用反证法，假设 $A$ 不可逆，则 $AA^*=|A|E=O$，易得 $A=O$。此时 $A$ 的全部代数余子式 $A_{ij}=0$，其伴随矩阵 $A^*=O$，与 $A^*$ 可逆矛盾。
                        
                        ???+ tip
                        	若 $AB=O$ 且 $B$ 可逆，则 $A=O$：因为等式两边同时乘以 $B^{-1}$ 可得 $ABB^{-1}=OB^{-1}$，即 $A=O$。

        - 下面没写 $A^{-1}$ 的都是 $|A|=0$ 也成立：

            - $A^*=|A|A^{-1}$，$A^{-1}=\frac{A^*}{|A|}$，$A=|A|(A^*)^{-1}$

            - $(kA)^*=k^{n-1}A^*$，$(A^T)^*=(A^*)^T$，$(A^{-1})^*=(A^*)^{-1}=\frac A {|A|}$，$(A^*)^*=|A|^{n-2}A$，$(AB)^*=B^*A^*$

            ??? note "证明（仅证明 $|A|\neq 0$ 的情况）"
                - 利用 $AA^*=|A|E$：

                    $A^{-1}AA^*=A^{-1}|A|E\Rightarrow A^*=A^{-1}|A|$，$A^{-1}=\dfrac{1}{|A|}A^*$
                
                    $AA^*(A^*)^{-1}=|A|E(A^*)^{-1}\Rightarrow A=|A|(A^*)^{-1}$
                
                - 利用 $A^*=|A|A^{-1}$
                
                    $(kA)^*=|kA|(kA)^{-1}\Rightarrow (kA)^*=k^n|A|\cdot \dfrac 1 k A^{-1}=k^{n-1}|A|A^{-1}=k^{n-1}A^*$
                
                    $(A^T)^*=|A^T|(A^T)^{-1}=|A|(A^{-1})^T=(|A|A^{-1})^T=(A^*)^T$
                
                    $(A^{-1})^*=|A^{-1}|(A^{-1})^{-1}=(|A|A^{-1})^{-1}=(A^*)^{-1}$
                
                    $(A^*)^*=|A^*|(A^*)^{-1}=|A|^{n-1}(|A|A^{-1})^{-1}=|A|^{n-2}A$
                
                    $(AB)^*=|AB|(AB)^{-1}=|B|B^{-1}|A|A^{-1}=B^*A^*$

            ???+ warning "注意"
                $(A+B)^*\neq A^*+B^*$

### 分块矩阵

- 分块矩阵的定义

	将矩阵 $A$ 用若干条纵线和横线分成许多个小矩阵，每一个小矩阵称为 $A$ 的子块，以子块为元素的形式上的矩阵称为分块矩阵。
	
- 分块矩阵的运算

	分块矩阵的运算规则与普通矩阵的运算规则类似。
	
	- 加法：两个矩阵同型且采用相同的分块法。
	- 数乘
	- 乘法：1. 分块前可以乘（$A$ 列数等于 $B$ 行数）；2. 分块完可以乘（$A$ 列分块方式与 $B$ 行分块方式一致）
	- 转置：块之间转置，块内也转置。
	
		$\begin{pmatrix} A_{11} & A_{12} & \cdots & A_{1k} \\ A_{21} & A_{22} & \cdots & A_{2k} \\ \vdots & \vdots & \ddots & \vdots \\ A_{m1} & A_{m2} & \cdots & A_{mk} \end{pmatrix}^T = \begin{pmatrix} A_{11}^T & A_{21}^T & \cdots & A_{m1}^T \\ A_{12}^T & A_{22}^T & \cdots & A_{m2}^T \\ \vdots & \vdots & \ddots & \vdots \\ A_{1k}^T & A_{2k}^T & \cdots & A_{mk}^T \end{pmatrix}$

	- 分块三角矩阵的逆矩阵
		
		$\begin{pmatrix} A_m & C \\ O & B_n \end{pmatrix}^{-1} = \begin{pmatrix} A^{-1} & -A^{-1}CB^{-1} \\ O & B^{-1} \end{pmatrix}$，$\begin{pmatrix} A_m & O \\ C & B_n \end{pmatrix}^{-1} = \begin{pmatrix} A^{-1} & O \\ -B^{-1}CA^{-1} & B^{-1} \end{pmatrix}$

		$\begin{pmatrix} C & A_m \\ B_n & O \end{pmatrix}^{-1} = \begin{pmatrix} O & B^{-1} \\ A^{-1} & -A^{-1}CB^{-1} \end{pmatrix}$，$\begin{pmatrix} O & A_m \\ B_n & C \end{pmatrix}^{-1} = \begin{pmatrix} -B^{-1}CA^{-1} & B^{-1} \\ A^{-1} & O \end{pmatrix}$

		主：位置不动，直接逆。副：位置对换，再逆。
		
		$C$：添 $-$，然后同行靠左，同列靠右。
		
	- 分块（副）对角矩阵的逆矩阵（假设每个子块都可逆）
	
		$\begin{pmatrix} A_1 & & & \\ & A_2 & & \\ & & \ddots & \\ & & & A_n \end{pmatrix}^{-1} = \begin{pmatrix} A_1^{-1} & & & \\ & A_2^{-1} & & \\ & & \ddots & \\ & & & A_n^{-1}\end{pmatrix}$

		$\begin{pmatrix} & & & A_1 \\ & & A_2 & \\ & \ddots & & \\ A_n & & & \end{pmatrix}^{-1} = \begin{pmatrix} & & & A_{\textcolor{red}n}^{-1} \\ & & A_{\textcolor{red}2}^{-1} & \\ & \ddots & & \\ A_{\textcolor{red}1}^{-1} & & & \end{pmatrix}$

	- 分块对角矩阵的幂
		
		$\begin{pmatrix} A_1 & & & \\ & A_2 & & \\ & & \ddots & \\ & & & A_n \end{pmatrix}^n = \begin{pmatrix} A_1^n & & & \\ & A_2^n & & \\ & & \ddots & \\ & & & A_n^n \end{pmatrix}$
		
		注：分块副对角矩阵的幂无此规律。
	
	- 拉普拉斯公式
	
		① $\begin{vmatrix} A_m & O \\ * & B_n \end{vmatrix} = |A||B|, \quad \begin{vmatrix} A_m & * \\ O & B_n \end{vmatrix} = |A||B|$

        ② $ \begin{vmatrix} O & A_m \\ B_n & * \end{vmatrix} = (-1)^{mn}|A||B|, \quad \begin{vmatrix} * & A_m \\ B_n & O \end{vmatrix} = (-1)^{mn}|A||B|$
        
        ③ 若 $A=\begin{pmatrix} A_1 & & & \\ & A_2 & & \\ & & \ddots & \\ & & & A_k \end{pmatrix}$ 则 $|A| = |A_1||A_2|\cdots|A_k|$
        
        注：设 $G = \begin{pmatrix} A & B \\ C & D \end{pmatrix}$ 为 $k(k \geq 3)$ 阶分块矩阵，且 $|G| \neq 0$ ，则一般 ① $|G|\neq |AD - BC|$ ；②  $G^*\neq \begin{pmatrix} D & -B \\ -C & A \end{pmatrix}$ ；③  $G^{-1}\neq\dfrac{1}{|G|}\begin{pmatrix} D & -B \\ -C & A \end{pmatrix}$。



### 初等变换与初等矩阵

- 初等变换：互换，倍乘，倍加

- 初等矩阵的定义

	$E$ 经过一次初等变换得到的矩阵。

    - 互换初等矩阵：$E_{ij}$ 表示 $E\stackrel{R_{ij}}{\longrightarrow}$ 或 $E\stackrel{C_{ij}}{\longrightarrow}$ 所得的初等矩阵。
    - 倍乘初等矩阵：$E_i(k)$ 表示 $E\stackrel{kR_i}{\longrightarrow}$ 或 $E\stackrel{kC_i}{\longrightarrow}\,(k\neq 0)$ 所得的初等矩阵。
    - 倍加初等矩阵：$E_{ij}(k)$ 表示 $E\stackrel{R_i+kR_j}{\longrightarrow}$ 或 $E\stackrel{C_j+kC_i}{\longrightarrow}$（注意这里行/列有点区别）所得的初等矩阵。

- 初等矩阵的性质与重要公式

	- 初等矩阵的转置仍是初等矩阵

	- 初等矩阵都是可逆矩阵，且 $[E_i(k)]^{-1}=E_i(\frac 1 k)$，$E_{ij}^{-1}=E_{ij}$，$[E_{ij}(k)]^{-1}=E_{ij}(-k)$，其逆矩阵仍是同一类型的初等矩阵。
	
	- 对矩阵 $A$ 进行初等行变换，相当于矩阵 $A$ 左乘对应的初等矩阵；对矩阵 $A$ 进行初等列变换，相当于矩阵 $A$ 右乘相应的初等矩阵。
	
	- $A$ 可逆 $\Leftrightarrow$ $A$ 可以表示成若干初等矩阵的乘积。
	
		??? note "证明"
			
			$\Rightarrow$：$A_{n\times n}$ 可逆，则 $r(A)=n$，那么一定存在 $n$ 阶初等矩阵 $P_1,\cdots,P_s,Q_1,\cdots,Q_r$，使得 $P_1\cdots P_sAQ_\cdots Q_t=E$，即 $P_s^{-1}\cdots P_1^{-1}P_1,\cdots,P_sAQ_1\cdots Q_tQ_t^{-1}\cdots Q_1^{-1}=P_s^{-1}\cdots P_1^{-1}EQ_t^{-1}\cdots Q_1^{-1}$，所以 $A=P_s^{-1}\cdots P_1^{-1}Q_t^{-1}\cdots Q_1^{-1}$【初等矩阵的逆仍然是初等矩阵】。
			
			$\Leftrightarrow$：显然。$A=P_1\cdots P_s$，$P_i$ 为初等矩阵，则 $|A|=|P_1|\cdots |P_s|\neq 0$。

- 用初等变换求逆矩阵的方法
	
	$\left(\begin{array}{c:c}A & B \\\end{array}\right)\xrightarrow{\text{初等行变换}}\left(\begin{array}{c:c}E & A^{-1}B \\\end{array}\right)$
	
	特别地，$\left(\begin{array}{c:c}A & E \\\end{array}\right)\xrightarrow{\text{初等行变换}}\left(\begin{array}{c:c}E & A^{-1} \\\end{array}\right)$
	
	$\begin{pmatrix}A \\\hdashline B\end{pmatrix} \xrightarrow{\text{初等列变换}} \begin{pmatrix}E \\\hdashline BA^{-1}\end{pmatrix}$
	
	特别地，$\begin{pmatrix}A \\\hdashline E\end{pmatrix} \xrightarrow{\text{初等列变换}} \begin{pmatrix}E \\\hdashline A^{-1}\end{pmatrix}$
	
	??? note "证明"
		
		$\left(\begin{array}{c:c}A & B \\\end{array}\right)\xrightarrow{\text{初等行变换}}\left(\begin{array}{c:c}A^{-1}A & A^{-1}B \\\end{array}\right)=\left(\begin{array}{c:c}E & A^{-1}B \\\end{array}\right)$
		
		即，$A^{-1}A=P_1\cdots P_sA=E$，$A^{-1}B=P_1\cdots P_sB=A^{-1}B$，也就是 $A$ 经过一系列初等行变换得到 $E$ 时，$B$ 经过同样的初等行变换得到 $A^{-1}B$

### 矩阵的秩

- 定义

	对于 $A_{m\times n}$，若存在 $k$ 阶子式不为 $0$，而任意 $k+1$ 阶子式（若有）全为 $0$，则 $r(A)=k$。

	$0\leq r(A)\leq \min\{m,n\}$
	
	$A$ 为 $n$ 阶满秩矩阵 $\Leftrightarrow r(A)=n\Leftrightarrow |A|\neq 0\Leftrightarrow$ $A$ 为可逆矩阵。
	
	$r(cA)=\begin{cases}0,&c=0\\r(A),&c\neq 0\end{cases}$，$r(A_n^{-1})=r(A_n)=n$（$A_n$ 可逆）

- 初等变换不改变矩阵的秩

	对于矩阵 $A_{m\times n}$ 和可逆矩阵 $P_{m\times m},Q_{n\times n}$，$r(A)=r(PA)=r(AQ)=r(PAQ)$。
	
	$r(A_{m\times n})=r\Leftrightarrow \exists$ 可逆矩阵 $P_{m\times m},Q_{n\times n}$，使得 $PAQ=\begin{pmatrix}E_r&O\\O&O\end{pmatrix}$。
		
	??? note "证明"
		因为可逆矩阵可以表示成初等矩阵的乘积，而初等变换不影响矩阵的秩。

- 矩阵的秩的重要结论

	1. 矩阵转置的秩
	
		$r(A)=r(A^T)=r(A^TA)=r(AA^T)$
	
	2. 矩阵和、差、积的秩
	
		- $\underbrace{r(A_{m\times n})+r(B_{n\times s})-n\leq r(AB)}_{\text{Sylvester 不等式}}\leq \min\{r(A),r(B)\}$
		
			??? note "证明"
				- 证明 Sylvester 不等式：
				
					$\begin{pmatrix}E&O\\O&AB\end{pmatrix}\xrightarrow{R_2+AR_2}\begin{pmatrix}E&O\\A&AB\end{pmatrix}\xrightarrow{C_2-C_1B}\begin{pmatrix}E&-B\\A&O\end{pmatrix}\xrightarrow{(-1)C_2}\begin{pmatrix}E&B\\A&O\end{pmatrix}$
					
					则 $n+r(AB)=r\begin{pmatrix}E&O\\O&AB\end{pmatrix}=r\begin{pmatrix}E&B\\A&O\end{pmatrix}\geq r\begin{pmatrix}O&B\\A&O\end{pmatrix}=r(A)+r(B)$
		
		- Frobenius（弗罗贝尼乌斯）不等式：$r(ABC)\geq r(AB)+r(BC)-r(B)$

		- $r(A)-r(B)\leq r(A\pm B)\leq r(A)+r(B)$
	
			??? note "证明"
				$\begin{pmatrix}A&O\\O&B\end{pmatrix}\xrightarrow{C_2+C_1}\begin{pmatrix}A&A\\O&B\end{pmatrix}\xrightarrow{R_1+R_2}\begin{pmatrix}A&A+B\\O&B\end{pmatrix}$

				则 $r(A)+r(B)=r\begin{pmatrix}A&O\\O&B\end{pmatrix}=r\begin{pmatrix}A&A+B\\O&B\end{pmatrix}\geq r(A+B)$。
			
		- $\max\{r(A),r(B)\}\leq r(A,B)\leq r(A)+r(B)$
		
		- 若 $A_{m\times n},B_{n\times s}$ 且 $AB=O$，则 $r(A)+r(B)\leq n$。
		
		- 若 $P,Q$ 可逆，则 $r(A)=r(PA)=r(AQ)=r(PAQ)$。
		
			更一般地，若 $A$ 列满秩（即 $r(A_{m\times n})=n$），则 $r(AB)=r(B)$，且有左消去律 $AB=O\Rightarrow B=O$，$AB=AC\Rightarrow B=C$。（同理，$A$ 行满秩时有右消去律）
	
	3. 分块矩阵的秩
		
		$r\begin{pmatrix}A&O\\O&B\end{pmatrix}=r(A)+r(B)$
	
		$r\begin{pmatrix}A&O\\*&B\end{pmatrix}\geq r(A)+r(B)$
	
	4. 伴随矩阵的秩
	
		$r(A^*)=\begin{cases}n,&r(A)=n\\1,&r(A)=n-1\\0,&r(A)<n-1\end{cases}\,(n\geq 2)$，其中 $A$ 为 $n$ 阶方阵
	
		??? note "证明"
			- 若 $r(A)=n$：
				
				因为 $r(A)=n$，所以 $|A|\neq 0$，故 $|A^*|=|A|^{n-1}\neq 0$，$r(A^*)=n$。
			
			- 若 $r(A)=n-1$：
				
				???+ abstract
					证 $r(A^*)=1$，只需证 $r(A^*)\geq $ 和 $r(A^*)\leq 1$。
					
					1. 前者：即证 $A^*\neq O$，即存在 $A_{i,j}\neq 0$。
					
					2. 后者：$AA^*=A^*A=|A|E=O$，则 $r(A)+r(A^*)\leq n$。
				
				1. 因为 $r(A)=n-1$，所以 $A$ 存在 $n-1$ 阶子式不为 $0$。则 $A^*\neq O$，即 $r(A^*)\geq 1$。
				
				2. 因为 $r(A)<n$，所以 $|A|=0$，可得 $AA^*=|A|E=O$。则 $r(A)+r(A^*)\leq n\Rightarrow r(A^*)\leq 1$（若 $AB=O$，则 $r(A)+r(B)\leq A$ 的列数）。
				
				故 $r(A^*)=1$。
			
			- 若 $r(A)<n-1$：
			
				$A$ 中所有 $n-1$ 阶子式都为 $0$，所以 $A^*=O$，从而 $r(A^*)=0$。

## 公式总结

- $|kA|=k^n|A|$

	$(kA)^T=kA^T$
	
	$(kA)^{-1}=\dfrac 1 k A^{-1}\,(k\neq 0)$
	
	$(kA)^*=k^{n-1}A^*$

- $|A+B|\neq |A|+|B|$

	$(A+B)^T=A^T+B^T$
	
	$(A+B)^{-1}\neq A^{-1}+B^{-1}$
	
	$(A+B)^*\neq A^*+B^*$

- $(A^T)^{-1}=(A^{-1})^T$

	$(A^*)^{-1}=(A^{-1})^*$
	
	$(A^T)^*=(A^*)^T$
	
- $|AB|=|A||B|=|B||A|$

	$(AB)^T=B^TA^T$
	
	$(AB)^{-1}=B^{-1}A^{-1}$
	
	$(AB)^*=B^*A^*$
	
	推论：$(A^k)^{-1}=(A^{-1})^k$，$(A^k)^T=(A^T)^k$，$(A^k)^*=(A^*)^k$

- $(A^{-1})^{-1}=A$，$(A^T)^T=A$，$(A^*)^*=|A|^{n-2}A$（二阶有 $(A^*)^*=A$），$(A^k)^k=A^{k^2}$
- $|A^{-1}|=\dfrac 1 {|A|}$，$|A^T|=|A|$，$|A^*|=|A|^{n-1}$，$|A^k|=|A|^k$

## 题目

- 方阵的迹：$\text{tr}(A_{n\times n})=\sum_{i=1}^n a_{ii}$。$\text{tr}(A\pm B)=\text{tr}(A)\pm \text{tr}(B)$，$\text{tr}(kA)=k\text{tr}(A)$，$\text{tr}(AB)=\text{tr}(BA)$
	
	虽然一般 $AB\neq BA$，但是 $|AB|=|BA|$、$\text{tr}(AB)=\text{tr}(BA)$（$A,B$ 均为方阵）。
	
	$\text{tr}(\alpha\beta^T)=\beta^T\alpha$

- 方阵的幂：

    1. 若 $A$ 各行（列）成比例，即 $r(A)=1$：$A^n=[\text{tr}(A)]^{n-1}A$
    
    	??? note "证明"
    		利用 $A_{1\times n}B_{n\times 1}=C_{1 \times 1}$，$A_{n\times 1}\times B_{1\times n}=C_{n\times n}$：
	
	  		设 $\alpha=[a_1,a_2,\cdots,a_k]^T$，$\beta=[b_1,b_2,\cdots,b_k]^T$，$A=\alpha\beta^T$，则 $A^n=(\alpha\beta^T)^n=\alpha(\beta ^T\alpha)^{n-1}\beta^T$【将一列乘一行转化成一行乘一列。$\beta^T\alpha$ 是一个数】$=(\sum_{i=1}^k a_ib_i)^{n-1}A$。
	  		
	  		而若 $r(A)=1$，$A$ 一定可以拆成上面那种一列乘一行的形式。因为若 $A_{ij}=a_ib_j$，则 $A=[a_1,a_2,\cdots,a_k]^T[b_1,b_2,\cdots,b_k]$。$A^n=(\sum_{i=1}^k a_ib_i)^{n-1}A$【即主对角线元素之和的 $n-1$ 次方乘以 $A$】。
  
    2. 试算 $A^2,A^3$ 等，归纳出结果
    
    	残爪型
    
    3. 若 $A=B+C$ 且 $BC=CB$，则可将 $A^n=(B+C)^n$ 二项式展开
    
    	??? example "例题"
    		$A = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1 \end{pmatrix}$，求 $A^n$。
    	
    	      $A =\begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix} + \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{pmatrix} = E + B$
    	    
    	      当 $k\geq 3$ 时，$B^k=O$

- 方阵的多项式

	- 定义：设 $x$ 的 $k$ 次多项式 $f(x)=a_kx^k+a_{k-1}x^{k-1}+\cdots+a_1x+a_0$，$A$ 是 $n$ 阶矩阵，称 $f(A)=a_kA^k+a_{k-1}A^{k-1}+\cdots+a_1A+a_0E_n$ 为矩阵 $A$ 的一个 $k$ 次多项式。（只有 $A,E$，不能混入 $B$）
	- 性质：
		- 矩阵 $A$ 的两个多项式 $f(A)$ 和 $\varphi(A)$ 总是可交换的。（因为 $A^k,A^l,E$ 都可交换）
		- 矩阵 $A$ 的多项式可以像数的多项式一样相乘或因式分解。例如 $A^2+2A-3E=(A+3E)(A-E)$，$(A+E)(E-2A)=-2A^2-A+E$。
		- 若 $A = \begin{pmatrix} \lambda_1 &&& \\ & \lambda_2 && \\ && \ddots & \\ &&& \lambda_n \end{pmatrix}$ 为对角矩阵，则 $f(A) = a_0 E + a_1 A + \cdots + a_m A^m= \begin{pmatrix} f(\lambda_1) &&& \\ & f(\lambda_2) && \\ && \ddots & \\ &&& f(\lambda_n) \end{pmatrix}$

- 反对称矩阵：$A^T=-A$
	
	反对称矩阵的主对角元 $a_{ii}$ 全为 $0$。
	
	对于奇数阶的反对称矩阵 $A$，有 $|A|=0$。
	
	??? note "证明"
		设 $A$ 为 $n$ 阶反对称阵。$A^T=-A\Rightarrow |A^T|=|-A|\Rightarrow |A|=(-1)^n|A|$，$n$ 为奇数时 $|A|=-|A|$，即 $|A|=0$。
	
	任意一个 $n$ 阶矩阵 $A$ 都可以表示成一个对称矩阵与一个反对称矩阵的和，即 $A=\frac 1 2 (A+A^T)+\frac 1 2(A-A^T)$。（因为 $(A+A^T)^T=A^T+A$，$(A-A^T)^T=A^T-A$）


- 求逆矩阵
    - 用定义求逆矩阵

        1. 根据定义，若能找到矩阵 $B$ 使得 $AB = E$，则 $A$ 可逆，且 $A^{-1} = B$。

            ??? example "例题"
                设 $A,B$ 均是 $n$ 阶矩阵，且 $AB=A+B$，则：

                A. $A-E$ 为可逆矩阵；
                B. $A+E$ 为可逆矩阵；
                C. $A-2E$ 为可逆矩阵；
                D. $B+E$ 为可逆矩阵
                
                ??? note "解答"
                    $AB-A-B=0$
                
                    $A(B-E)-(B-E)=E$
                
                    $(A-E)(B-E)=E$
                
                    $A-E$ 与 $B-E$ 互为逆矩阵
                
                    答案：A
			    
			    $A_{n\times n},B_{n\times n}$，$A+2B=AB$，证明：$A-2E$ 可逆。
			    
			    ??? note "解答"
			    	$(A-2E)(B-E)=2E$，则 $(A-2E)^{-1}=\dfrac 1 2 (B-E)$。 
			
        2. 分解为可逆矩阵的乘积：若 $A = BC$ 且 $B,C$ 均可逆，则 $A$ 可逆【两个可逆矩阵的乘积仍可逆】，且 $A^{-1} = (BC)^{-1} = C^{-1}B^{-1}$。

            ??? example "例题"
                设 $A,B$ 是同阶可逆方阵，且 $A^{-1}+B^{-1}$ 可逆，证明 $A+B$ 是可逆矩阵，并求 $(A+B)^{-1}$。

                ??? note "解答"
                    $A+B=A(E+A^{-1}B)=A(B^{-1}+A^{-1})B$ 可逆
                
                    $(A+B)^{-1}=B^{-1}(B^{-1}+A^{-1})^{-1}A^{-1}$

        3. 简单分块矩阵的逆：若 $A,B$ 均为可逆方阵，则

            $\begin{pmatrix} A & O \\ O & B \end{pmatrix}^{-1} = \begin{pmatrix} A^{-1} & O \\ O & B^{-1} \end{pmatrix}$，$\begin{pmatrix} O & A \\ B & O \end{pmatrix}^{-1} = \begin{pmatrix} O & B^{-1} \\ A^{-1} & O \end{pmatrix}$

    - 用伴随矩阵求逆矩阵：若 $|A|\neq 0$，则 $A$ 可逆，且 $A^{-1}=\dfrac 1 {|A|}A^*$
    
		??? example "例题"
			已知 $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$，写出 $A$ 可逆的一个充要条件，当 $A$ 可逆时，求 $A^{-1}$。
    		
			??? note "解答"
    		
				① 求 $|A|=ad-bc$。$A$ 可逆 $\Leftrightarrow$ $ad\neq bc$
			
				② 求 $A^*=\begin{pmatrix}A_{11}&A_{21}\\A_{12}&A_{22}\end{pmatrix}=\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$
			
				???+ tip
					二阶矩阵 $A\to A^*$：主对调，副变号
			
				③ 则 $A^{-1}=\dfrac{A^*}{|A|}=\dfrac{1}{ad-bc}\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$
    
	- 用初等变换求逆矩阵

- 设 $A=P\begin{pmatrix}E_{r(A)}&O\\O&O\end{pmatrix}Q$ 的一类证明题

	??? example "例题"
		设 $r(A_{m\times n})=m\,(m\leq n)$，则存在 $B_{n\times m}$ 使得 $AB=E_m$。
	
		??? note "证明"
			
			???+ abstract
				先思考 $A$ 为相抵标准形的情况，再推广到一般情况。
				
				$A$ 为相抵标准形时，$A=\begin{pmatrix}E_m&O\end{pmatrix}$，取 $B=\begin{pmatrix}E_m\\O\end{pmatrix}$，则 $AB=\begin{pmatrix}E_m&O\end{pmatrix}\begin{pmatrix}E_m\\O\end{pmatrix}=E_m$
				
				然后用 $A=P\begin{pmatrix}E_m&O\end{pmatrix}Q$ 推广。
			
			$A=P\begin{pmatrix}E_m&O\end{pmatrix}Q$，取 $B=Q^{-1}\begin{pmatrix}E_m\\O\end{pmatrix}P^{-1}$，则 $AB=P\begin{pmatrix}E_m&O\end{pmatrix}QQ^{-1}\begin{pmatrix}E_m\\O\end{pmatrix}P^{-1}=E_m$
		
		设 $r(A_{n\times n})=r$，$A^2=A$，证明 $\text{tr}(A)=r$。
		
		??? note "解答"
			设 $A=P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}Q$。
			
			$A^2=A\Rightarrow P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}QP\begin{pmatrix}E_r&O\\O&O\end{pmatrix}Q=P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}Q\Rightarrow\begin{pmatrix}E_r&O\\O&O\end{pmatrix}QP\begin{pmatrix}E_r&O\\O&O\end{pmatrix}=\begin{pmatrix}E_r&O\\O&O\end{pmatrix}$
			
			将 $QP$ 分块为 $\begin{pmatrix}C_{r\times r}&F\\G&H\end{pmatrix}$，则 $\begin{pmatrix}E_r&O\\O&O\end{pmatrix}QP\begin{pmatrix}E_r&O\\O&O\end{pmatrix}=\begin{pmatrix}C_{r\times r}&O\\O&O\end{pmatrix}=\begin{pmatrix}E_{r\times r}&O\\O&O\end{pmatrix}$，于是有 $C_{r\times r}=E_r$。
			
			由于 $\text{tr}(AB)=\text{tr}(BA)$，所以 $\text{tr}(A)=\text{tr}(\begin{pmatrix}E_r&O\\O&O\end{pmatrix}QP)=\text{tr}(\begin{pmatrix}E_r&O\\O&O\end{pmatrix}\begin{pmatrix}E_r&F\\G&H\end{pmatrix})=\text{tr}\begin{pmatrix}E_r&O\\O&O\end{pmatrix}=r$。
		
		设 $r(A_{n\times n})=r$，证明：$\exists B_{n\times n}$ 且 $r(B)=n-r$，使得 $AB=O$。
		
		??? note "解答"
			设 $A=P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}Q$。
			
			取 $B=Q^{-1}\begin{pmatrix}O&O\\O&E_{n-r}\end{pmatrix}$，则有 $r(B)=n-r$ 且 $AB=P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}\begin{pmatrix}O&O\\O&E_{n-r}\end{pmatrix}=P\cdot O=O$。
	
		设 $r(A_{n\times n})=1$，证明：$\exists$ 不全为 $0$ 的实数 $a_1,a_2,\cdots,a_n$ 和不全为 $0$ 的实数 $b_1,b_2,\cdots,b_n$，使得 $A=(a_1,a_2,\cdots,a_n)^T(b_1,b_2,\cdots,b_n)$。
		
		??? note "解答"
			设 $A=P\begin{pmatrix}1&0&\cdots&0\\0&0&\cdots&0\\\vdots&\vdots&\ddots&\vdots\\0&0&\cdots&0\end{pmatrix}Q$，则 $A=P\begin{pmatrix}1\\0\\\vdots\\0\end{pmatrix}\cdot \begin{pmatrix}1&0&\cdots&0\end{pmatrix}Q=\begin{pmatrix}p_{11}\\p_{21}\\\vdots\\p_{n1}\end{pmatrix}\begin{pmatrix}q_{11}&q_{12}&\cdots&q_{1n}\end{pmatrix}$。
			
			由于 $P,Q$ 可逆，显然 $\begin{pmatrix}p_{11}\\p_{21}\\\vdots\\p_{n1}\end{pmatrix}$ 和 $\begin{pmatrix}q_{11}&q_{12}&\cdots&q_{1n}\end{pmatrix}$ 不全为 $0$。

- 利用矩阵的秩的性质进行证明

	??? example "例题"
		设 $A_{m\times n}X_{n\times 1}=d_{m\times 1}$ 有解，$B_{m\times s}X_{s\times 1}=c_{m\times 1}$ 无解，令 $G=(A,B,d,c)_{m\times (n+s+2)}$（将 $A,B,d,c$ 列拼接），证明：$r(G)\leq r(A)+r(B)+1$。
		
		??? note "解答"
			$A_{m\times n}X_{n\times 1}=d_{m\times 1}$ 有解 $\Rightarrow r(A|d)=r(A)$
			
			$B_{m\times s}X_{s\times 1}=c_{m\times 1}$ 无解 $\Rightarrow r(B|c)=r(B)+1$
			
			则 $r(A,B,d,c)\leq r(A|d)+r(B|c)\leq r(A)+r(B)+1$。

- 构造分块矩阵的一类题

- “摄动法” 处理 “不可逆情形”