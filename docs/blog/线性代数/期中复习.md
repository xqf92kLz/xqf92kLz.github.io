《从 0 开始刷题》

## 行列式展开

- $|A|=\sum_{j=1}^n a_{ij}A_{ij}$

	看到 $a_{ij}$ 和 $A_{ij}$ 同时出现可以写一下这个式子。比如，有 $a_{ij}=A_{ij}$，$a_{i1}\neq 0$，即可推出 $|A|=\sum_{j=1}^n a_{ij}^2\neq 0$。

## 矩阵运算

- 特殊矩阵：
	- 对称矩阵：$A=A^T$
		- 能写成 $A\begin{pmatrix}E_r&O\\O&O\end{pmatrix}A^T$ 的形式
	- 正交矩阵：$A^TA=AA^T=E$
	- 幂零矩阵：$\exists m>0$，$A^m=O$
	- 幂等矩阵：$A^2=A$
		- $A(E-A)=O$，则 $r(A)+r(E-A)\leq n$。又 $r(A)+r(E-A)\geq r(E)=n$，则 $r(A)+r(A-E)=n$
		- 能写成 $P\begin{pmatrix}E_r&O\\O&O\end{pmatrix}P^{-1}$ 的形式
	- 对合矩阵：$A^2=E$（$A=A^{-1}$）

- 变换
	
	- $E$ 的替换（注意有时要主动乘一个 $E$）：
	
        ???+ example "例题"
        
            设 $A,B,C\in\mathbb P^{n\times n}$，且 $AB=BC=CA=E$，求 $A^2+B^2+C^2$。
        
            ??? note "解答"
                $A^2=A(BC)A=(AB)(CA)=E$
        
                $B^2=B(CA)B=(BC)(AB)=E$
        
                $C^2=C(AB)C=(CA)(BC)=E$
        
                故 $A^2+B^2+C^2=3E$
        
		    设 $A,B\in\mathbb P^{n\times n}$，$AA^T=E$，$BB^T=E$，$|A|+|B|=0$，求 $|A+B|$。
		    
		    ??? note "解答"
		    	$A+B=AB^TB+AA^TB=A(B^T+A^T)B=A(A+B)^TB$
		    	
		    	$|A+B|=|A||(A+B)^T||B|$
		    	
		    	$(1-|A||B|)|A+B|=0$
		    	
		    	又 $|A|=\pm 1$，$|B|=\pm 1$，$|A|=-|B|$，故 $|A||B|=-1$，$1-|A||B|=2\neq 0$。
		    	
		    	故 $|A+B|=0$。
		    
            设 $A,B\in\mathbb P^{n\times n}$，且 $E+AB$ 可逆，化简：$(E+BA)[E-B(E+AB)^{-1}A]$。
        
            ??? note "解答"
                $\begin{aligned}&=E-B(E+AB)^{-1}A+[BA-BAB(E+AB)^{-1}A]\\&=E-B(E+AB)^{-1}A+B(E-AB(E+AB)^{-1})A\\&=E-B(E+AB)^{-1}A+B((E+AB)(E+AB)^{-1}-AB(E+AB)^{-1})A\\&=E-B(E+AB)^{-1}A+B(E+AB)^{-1}A\\&=E\end{aligned}$
        
                其中最关键的是 $E-AB(E+AB)^{-1}=(E+AB)(E+AB)^{-1}-AB(E+AB)^{-1}=(E+AB)^{-1}$ 这步。
            
            ???+ tip
            	$E=AA^{-1}$
        
            设 $A$ 为 $n$ 阶对称阵，$A$ 可逆，$(A-B)^2=E$，化简：$(E+A^{-1}B^T)^T(E-BA^{-1})^{-1}$。
            
            ??? note "解答"
            	$(E+A^{-1}B^T)^T=E+B(A^{-1})^T=E+B(A^T)^{-1}=E+BA^{-1}=(A+B)A^{-1}$【$E=AA^{-1}$】
            	
            	$(E-BA^{-1})^{-1}=((A-B)A^{-1})^{-1}=A(A-B)^{-1}$
            	
            	则 $(E+A^{-1}B^T)^T(E-BA^{-1})^{-1}=(A+B)A^{-1}A(A-B)^{-1}=(A+B)(A-B)^{-1}=(A+B)(A-B)$【$(A-B)^2=E\Rightarrow (A-B)^{-1}=A-B$】
            
            ???+ tip
            	$E+AB=(B^{-1}+A)B=A(A^{-1}+B)$，$E+A^{-1}BA=A^{-1}A+A^{-1}BA=A^{-1}(E+B)A$
	  
	- 构造新等式，如利用幂等性
	
		???+ example "例题"
			设 $A,B\in\mathbb P^{n\times n}$，$A^2=A$，$B^2=B$，$(A-B)^2=A+B$，证明：$AB=BA=O$。
			
			??? note "解答"
				$(A-B)^2=A^2-AB-BA+B^2=A+B\Rightarrow AB+BA=O$ ①
				
				① 式左乘 $A$，又 $A^2=A$，有 $AB+ABA=O$
				
				① 式右乘 $A$，$ABA+BA=O$
				
				得 $AB=BA$ ②
				
				①② $\Rightarrow AB=BA=O$。
			
			设 $A,B$ 都是对合矩阵，证明：$AB$ 是对合矩阵 $\Leftrightarrow$ $A$ 与 $B$ 乘法可交换。
			
			??? note "解答"
				$\Rightarrow$：设 $AB$ 是对合矩阵，即有 $E=(AB)^2=ABAB$，两边同时左乘 $A$ 右乘 $B$，得 $AEB=AABABB\Rightarrow AB=BA$。
				
			$\Leftarrow$：设 $AB=BA$，两边同时右乘 $AB$，得 $ABAB=BAAB\Rightarrow (AB)^2=E$，故 $AB$ 为对合矩阵。
	
- 矩阵的幂

	- 数学归纳法：先求出次数较低的幂，观察，再归纳证明
	- 将矩阵拆分成两个可交换矩阵的和，再二项式定理展开
	- $(\alpha^T\beta)^n=(\beta\alpha^T)^{n-1}A$
	- 注意到低次幂为 $O$，则后续高次幂也是 $O$。
		
		???+ example "例题"
			设 $A=\begin{pmatrix}1&0&1\\0&2&0\\1&0&1\end{pmatrix}$，$n\geq 2$，求 $A^n-2A^{n-1}$。
			
			??? note "解答"
				$A^n-2A^{n-1}=A^{n-1}(A-2E)$
				
				$n=2$ 时，$A(A-2E)=O$；$n>2$ 时，$A^{n-2}\cdot A(A-2E)=O$。
				
				故答案是 $O$。

- 矩阵的乘法交换性

	???+ example "例题"
		证明：与任意 $n$ 阶方阵乘法可交换的方阵 $A$ 一定是数量矩阵。
		
		??? note "解答"
			设 $E_{ij}$ 表示第 $i$ 行第 $j$ 列的元素为 $1$，其他元素全为 $0$ 的 $n$ 阶方阵。
			
			$AE_{ij}$ 的第 $j$ 列是 $A$ 的第 $i$ 列，其余元素为 $0$。$(AE_{ij})_{ij}=a_{ii}$。
			
			$E_{ij}A$ 的第 $i$ 行是 $A$ 的第 $j$ 行，其余元素为 $0$。$(E_{ij}A)_{ij}=a_{jj}$。
			
			$A$ 与 $E_{ij}$ 可交换 $\Rightarrow$ $A$ 为数量矩阵。

- 注意矩阵的运算规律和行列式的性质之间的联系和区别

	???+ example "例题"
		设四阶矩阵 $A=(\alpha,\gamma_2,\gamma_3,\gamma_4)$，$B=(\beta,\gamma_2,\gamma_3,\gamma_4)$，其中 $\alpha,\beta,\gamma_2,\gamma_3,\gamma_4$ 均为四维列向量，且已知 $|A|=4,|B|=1$，求 $|A+B|$。
		
		??? note "解答"
			$|A+B|=|\alpha+\beta,2\gamma_2,2\gamma_3,2\gamma_4|=8|\alpha+\beta,\gamma_2,\gamma_3,\gamma_4|=8(|A|+|B|)=40$

- 观察矩阵规模

	???+ example "例题"
		设 $A$ 为 $n$ 阶反对称矩阵，证明：对于任意 $n$ 维列向量 $\alpha$，都有 $\alpha^TA\alpha=0$。
		
		??? note "解答"
			
			$(\alpha^TA\alpha)^T=\alpha^TA^T\alpha=-\alpha^TA\alpha$
			
			然后注意到 $\alpha^TA\alpha$ 是一个数，所以转置就是本身，即 $(\alpha^TA\alpha)^T=\alpha^TA\alpha$。
			
			故 $\alpha^TA\alpha=0$。

## 逆矩阵

- 可逆的上（下）三角矩阵的逆矩阵仍为上（下）三角矩阵

- 利用定义求逆矩阵

	???+ example "例题"
		设 $A^k=O\,(k>0)$，$E-A$ 可逆，求 $(E-A)^{-1}$，$(E+A)^{-1}$。
		
		??? note "解答"
			$(E-A)(E+A+A^2+\cdots+A^{k-1})=E+A+\cdots+A^{k-1}-A-A^2-\cdots-A^{k-1}-A^k=E-A^k=E$
			
			$\Rightarrow (E-A)^{-1}=E+A+A^2+\cdots+A^{k-1}$
			
			$(E+A)(E-A+A^2-A^3+\cdots+(-1)^{k-1}A^{k-1})=E+(-1)^{k-1}A^{k-1}$
			
			$\Rightarrow (E+A)^{-1}=E-A+A^2-A^3+\cdots+(-1)^{k-1}A^{k-1}$


- 用行列式判定矩阵的可逆性

	???+ example "例题"
		设 $A,B\in\mathbb P^{n\times n}$，$|B|\neq 0$，$A-E$ 可逆，$(A-E)^{-1}=(B-E)^T$，证明：$A$ 可逆。
		
		??? note "解答"
			由于 $(A-E)^{-1}=(B-E)^T$，则 $(A-E)(B-E)^T=(A-E)(B^T-E)=AB^T-A-B^T+E=E$，则 $A=B^T(B^T-E)^{-1}=B^T(A-E)$，$|A|=|B||A-E|\neq 0$，故 $A$ 可逆。

## 矩阵的秩

- 利用常见公式求矩阵的秩

	???+ example "例题"
		
		设 $A\in\mathbb P^{4\times 3}$，$r(A)=2$，$B=\begin{pmatrix}1&0&2\\0&2&0\\-1&0&3\end{pmatrix}$，求 $r(AB)$。
		
		??? note "解答"
			$|B|=10\neq 0$，故 $B$ 可逆，$r(AB)=r(A)=2$。
		
		???+ tip
			求秩可以把可逆矩阵因子扔掉
		
		设 $A=\begin{pmatrix}a&b&b\\b&a&b\\b&b&a\end{pmatrix}$，$r(A^*)=1$，求 $a,b$ 关系。
		
		??? note "解答"
			因为 $r(A^*)=1$，所以 $r(A)=2<3$，从而 $|A|=0$。
			
			$|A|=(a+2b)(a-b)^2=0$ 得 $a+2b=0$ 或 $a=b$。
			
			当 $a=b$ 时，$r(A)=1$，舍去。所以 $a+2b=0$ 且 $a\neq b$。
		
		???+ tip
			注意 $r(A)$ 和 $r(A^*)$ 之间有关系
			
		设 $A,B\in\mathbb P^{4\times 4}$，$r(A)=3$，$r(B)=4$，求 $r(A^*B^*)$。
		
		??? note "解答"
			$r(A)=3\Rightarrow r(A^*)=1$
			
			$r(B)=4\Rightarrow r(B^*)=4$，从而 $B^*$ 可逆
			
			$r(A^*B^*)=r(A^*)=1$
		
		设 $A\in\mathbb P^{2\times 2}$，$A^2=E$，$A\neq \pm E$。证明：$r(A+E)=r(A-E)=1$。
		
		??? note "解答"
			$(A+E)(A-E)=O\Rightarrow r(A+E)+r(A-E)\leq 2$，又 $A\neq \pm E$，即 $r(A+E)=r(A-E)\neq 0$，故 $r(A+E)=r(A-E)=1$。
		
		设 $A\in\mathbb P^{n\times n}$，$A^2=E$，证明：$r(A+E)+r(A-E)=n$。
		
		??? note "解答"
			$(A+E)(A-E)=O\Rightarrow r(A+E)+r(A-E)\leq n$
			
			又 $r(A+E)+r(A-E)\geq r[(A+E)-(A-E)]=n$
			
			故 $r(A+E)+r(A-E)=n$。
		
		设 $A,B\in\mathbb P^{n\times n}$，$A^2=A$，$B^2=B$，$E-A-B$ 可逆，证明：$r(A)=r(B)$。
		
		??? note "解答"
			- **法 1：**
			
				由于 $E-A-B$ 可逆，有 $r(E-A-B)=n$。$r(E-A)+r(B)\geq r(E-A-B)\Rightarrow r(B)\geq n-r(E-A)$。
			
  	          $A^2=A\Rightarrow A(E-A)=O$，则 $r(A)+r(E-A)\leq n$，$r(A)\leq n-r(E-A)$。
		
  	          则有 $r(B)\geq n-r(E-A)\geq r(A)$。
		
  	          交换 $A$ 和 $B$ 的角色，同理可证 $r(A)\geq r(B)$，因此 $r(A)=r(B)$。
			
			- **法 2：**
			
				$A(E-A-B)=A-A^2-A=-AB$
				
				又 $E-A-B$ 可逆，则 $r(A)=r(AB)$
				
				$B(E-A-B)=B-AB-B^2=-AB$，则 $r(B)=r(AB)$
				
				$\Rightarrow r(A)=r(B)$
		
		求满足 $A^*=A$ 的所有 $n$ 阶方阵 $A$。
		
		??? note "解答"
			若 $r(A)<n-1$，则 $r(A^*)=0$，$A^*=O$，此时只有 $A=O$ 时有 $A^*=A$。
			
			若 $r(A)=n-1$，则 $r(A^*)=1$。当 $n>2$ 时，显然 $A^*\neq A$；当 $n=2$ 时，$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$，$A^*=\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$，只有 $a=d,b=c=0$ 才有 $A=A^*$，然而此时 $A=\begin{pmatrix}a&0\\0&a\end{pmatrix}$ 与 $r(A)=1$ 矛盾。故 $A^*\neq A$。
			
			若 $r(A)=n$，则 $r(A^*)=n$，于是 $A=A^*\Leftrightarrow A^2=|A|E$。
			
			综上，满足 $A^*=A$ 的方阵是：零方阵及适合 $A^2=|A|E$ 的所有可逆方阵。

## 小结论

- 分块矩阵的行列式公式：

	若 $A$ 可逆，则 $\begin{vmatrix}A&B\\C&D\end{vmatrix}=|A||D-CA^{-1}B|$。

	若 $D$ 可逆，则 $\begin{vmatrix}A&B\\C&D\end{vmatrix}=|D||A-BD^{-1}C|$。

	若 $A,D$ 都可逆，则 $|A||D-CA^{-1}B|=|D||A-BD^{-1}C|$。如果用 $-B$ 代替 $B$，可得 $|A||D+CA^{-1}B|=|D||A+BD^{-1}C|$。

	???+ note "证明"
		$\begin{pmatrix}A&B\\C&D\end{pmatrix}\xrightarrow{R_2-CA^{-1}R_1}\begin{pmatrix}A&B\\O&D-CA^{-1}B\end{pmatrix}$
  	

		$\begin{pmatrix}A&B\\C&D\end{pmatrix}\xrightarrow{R_1-BD^{-1}R_2}\begin{pmatrix}A-BD^{-1}C&O\\C&D\end{pmatrix}$

- 设 $u,v$ 是 $n$ 维列向量，则 $|E_n+uv^T|=1+v^Tu$。

	???+ note "证明"
		
		$\begin{pmatrix}E_n+uv_T&u\\O&1\end{pmatrix}\xrightarrow{C_1-C_2v_T}\begin{pmatrix}E_n&u\\-v_T&1\end{pmatrix}$
		
		前者的行列式为 $|E_n+uv^T|$ $|E_n||1+v^Tu|$，后者的行列式为 $|E_n||1+v^Tu|$（根据分块矩阵的行列式公式）

- 矩阵行列式定理：设 $A$ 是 $n$ 阶可逆矩阵，$u,v$ 是 $n$ 维列向量，则 $|A+uv^T|=|A||1+v^TA^{-1}u|$。

	???+ note "证明"
		$|A+uv^T|=|A(E+A^{-1}uv^T)|=|A||E+A^{-1}uv^T|=|A||1+v^TA^{-1}u|$【因为 $|E+uv^T|=|1+v^Tu|$】

## LU 分解

## 摄动法

- 设 $A\in\mathbb P^{n\times n}$，$f(t)=|tE_n+A|$。由于 $f(t)$ 是关于 $t$ 的多项式且 $t^n$ 项系数为 $1$，所以当 $t$ 充分大时，$f(t)>0$。

## 刷历年卷

???+ info "2020-2021"

	设 $A\in\mathbb P^{n\times n}$，$a_{ij}=1$。
	
	（1）求 $a,b$ 使得 $aA^2+bA=O$。
	
	??? note "解答"
		$A^2=nA$
		
		$(an+b)A=O$
		
		取 $a=1,b=-n$
	
	（4）求 $(A+E)^{-1}$。
	
	??? note "解答"
		$A^2-nA+?E=?E$
		
		$(A+E)(A-(n+1)E)=-(n+1)E$
		
		$(A+E)^{-1}=E-\dfrac{1}{n+1}A$
	
	设 $A,B\in\mathbb P^{n\times n}$，证明：$r(A)=r(AB)\Leftrightarrow \exists C,A=ABC$。
	
	??? note "解答"
		- $\Rightarrow$：
		
			$A$ 的第 $i$ 列 $\boldsymbol a_i$ 可以表示为 $AB$ 的列的线性组合（因为 $r(AB)=r(AB,\boldsymbol_i)$）：$\boldsymbol a_i=(AB)\boldsymbol c_i$，其中 $\boldsymbol c_i$ 是一个 $n$ 维列向量。
			
			取 $C=(\boldsymbol_1,\boldsymbol_2,\cdots,\boldsymbol_n)$ 即可。
		- $\Leftrightarrow$：
		
			$r(A)=r(ABC)\leq r(AB)\leq r(A)$，则 $r(A)=r(AB)$。

???+ info "2018-2019"
	设 $AA^T=E$，$|A|<0$，求 $|A+E|$。
	
	??? note "解答"
		先 $E$ 的替换；$|A+E|=|A+AA^T|=|A||E+A^T|$
		
		注意到 $|E+A^T|=|(E+A)^T|=|E+A|$
		
		则 $|A+E|(1-|A|)=0$
		
		又 $1-|A|>0$，则 $|A+E|=0$

???+ info "2018-2019"
	设 $A=A^T$，$|A|=0$，证明：$A_{ii}A_{jj}=(A_{ij})^2$。
	
	??? note "解答"
		$|A|=0$，则 $r(A^*)\leq 1$
		
		则 $\begin{vmatrix}A_{ii}&A_{ij\\A_{ji}&A_{jj}\end{vmatrix}=0$，则 $A_{ii}A_{jj}=A_{ij}A_{ji}=(A_{ij})^2$【$A$ 对称 $\Rightarrow$ $A^*$ 对称】

???+ info "2017-2018"
	设 $A^3=2E$，$B=A^2-2A+E$，证明 $B$ 可逆，并求 $B^{-1}$。
	
	??? note "解答"
		$(A-E)(A^2+A+E)=E$，则 $(A-E)^{-1}=A^2+A+E$
		
		$B=(A-E)^2$，则 $B^{-1}=[(A-E)^{-1}]^2=(A^2+A+E)^2=3A^2+4A+5E$

???+ info "2017-2018"
	设 $A,B,C,D\in\mathbb P^{n\times n}$，证明：当 $AC=CA$ 时，有 $\begin{vmatrix}A&D\\C&B\end{vmatrix}=|AB-CD|$。 
	
	??? note "解答"
		$A$ 可逆时，$\begin{vmatrix}A&&D\\C&B\end{vmatrix}=|A||B-CA^{-1}D|=|AB-ACA^{-1}D|=|AB-CD|$
		
		$A$ 不可逆时，由于当 $t$ 充分大时 $|tE_n+A|>0$，$\begin{vmatrix}tE_n+A&&D\\C&B\end{vmatrix}=|(tE_n+A)B-CD|$，等式两边关于 $t$ 的多项式常数项相等，故 $\begin{vmatrix}A&D\\C&B\end{vmatrix}=|AB-CD|$。

???+ info "2016-2017"
	把 $\begin{pmatrix}a&0\\0&\frac 1 a\end{pmatrix}$ 表示成若干个 $\begin{pmatrix}1&x\\0&1\end{pmatrix}$ 和 $\begin{pmatrix}1&0\\y&1\end{pmatrix}$ 型的乘积。
	
	??? note "解答"
		利用第三种初等变换
		