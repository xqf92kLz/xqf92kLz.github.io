### 二次型的基本概念

- 二次型及其矩阵表示

    - 二次型：

        含有 $n$ 个变量 $x_1,x_2,\cdots,x_n$ 的二次齐次多项式 $f(x_1,x_2,\cdots,x_n)=\sum_{i=1}^n\sum_{j=1}^n a_{ij}x_ix_j$，其中 $a_{ij}=a_{ji}\,(i,j=1,2,\cdots,n)$，称为 $n$ 元二次型，简称二次型。

    - 二次型的矩阵：

        二次型可改写成矩阵向量的形式 $f=\boldsymbol x^T\boldsymbol A\boldsymbol x$，其中 $\boldsymbol x=(x_,x_2,\cdots,x_n)^T$，$\boldsymbol A=\begin{pmatrix}a_{11}&a_{12}&\cdots&a_{1n}\\a_{21}&a_{22}&\cdots&a_{2n}\\\vdots&\vdots&\ddots&\vdots\\a_{n1}&a_{n2}&\cdots&a_{nn}\end{pmatrix}$ 为对称矩阵，$\boldsymbol A$ 称为二次型 $f$ 的矩阵（唯一），$\boldsymbol A$ 的秩称为二次型 $f$ 的秩。
        
        注：① 看到 $\boldsymbol x^T\boldsymbol A\boldsymbol x$ 要接受这是二次型，是个多项式；② 二次型与对称矩阵之间存在一一对应的关系，$f$ 称为对称矩阵 $\boldsymbol A$ 的二次型。
        
        ???+ example "例题"
        	设二次型 $f(x_1,x_2,x_3)=-4x_1x_2+2x_1x_3+2tx_2x_3$ 的秩为 $2$，求 $t$。
        	
        	??? note "解答"
        		二次型矩阵 $\boldsymbol A=\begin{pmatrix}0&-2&1\\-2&0&t\\1&t&0\end{pmatirx}$，则 $r(\boldsymbol A)=2<3$，$|\boldsymbol A|=-2t-2t=-4t=0$，得 $t=0$。
        	
        	求二次型 $f(x_1,x_2,x_3)=(x_1,x_2,x_3)\begin{pmatrix}1&0&3\\4&-1&2\\3&4&0\end{pmatrix}\begin{pmatrix}x_1\\x_2\\x_3\end{pmatrix}$ 对应的矩阵 $\boldsymbol A$。
        	
        	??? note "解答"
        		$\boldsymbol A=\begin{pmatrix}1&2&3\\2&-1&3\\3&3&0\end{pmatrix}$
        		
        		（主对角线不变，对称位置取平均）

	- 可逆线性变换：
	
		如果 $\begin{cases}x_1=c_{11}y_1+c_{12}y_2+\cdots+c_{1n}y_n\\x_2=c_{21}y_1+c_{22}y_2+\cdots+c_{2n}y_n\\\cdots\\x_n=c_{n1}y_1+c_{n2}y_2+\cdots+c_{nn}y_n\end{cases}\,(*)$ 满足 $|\boldsymbol C|=\begin{vmatrix}c_{11}&c_{12}&\cdots&c_{1n}\\c_{21}&c_{22}&\cdots&c_{2n}\\\vdots&\vdots&\ddots&\vdots\\c_{n1}&c_{n2}&\cdots&c_{nn}\end{vmatrix}\neq 0$，称 $(*)$ 为从变量 $\boldsymbol x=(x_1,x_2,\cdots,x_n)^T$ 到 $\boldsymbol y=(y_1,y_2,\cdots,y_n)^T$ 的可逆线性变换，记作 $\boldsymbol x=\boldsymbol C\boldsymbol y$，其中 $\boldsymbol C$ 可逆。
		
		注：若 $\boldsymbol C$ 为正交矩阵，则称 $\boldsymbol x=\boldsymbol C\boldsymbol y$ 为正交变换。

### 正交变换化二次型为标准形

- 化二次型为标准形

	- 标准形：如果二次型中只含有变量的平方项，即 $f=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y=d_1y_1^2+d_2y_2^2+\cdots+d_ny_n^2$，称为二次型 $f$ 的标准形。

		注：① 二次型 $f$ 的标准形的矩阵为对角矩阵；② 二次型 $f$ 的标准形不是唯一的，与所做的可逆线性变换有关。
	
	- 重要定理
		- 任一个 $n$ 元二次型 $f(x_1,x_2,\cdots,x_n)=\boldsymbol x^T\boldsymbol A\boldsymbol x$，都必存在正交矩阵 $\boldsymbol x=\boldsymbol Q\boldsymbol y$（$\boldsymbol Q$ 为正交矩阵），使得该二次型化为标准形 $f(x_1,x_2,\cdots,x_n)=\lambda_1y_1^2+\lambda_2y_2^2+\cdots+\lambda_ny_n^2$，其中 $\lambda_1,\lambda_2,\cdots,\lambda_n$ 为实对称矩阵 $\boldsymbol A$ 的 $n$ 个特征值。
			
			矩阵表述：任一个 $n$ 阶是对称矩阵 $\boldsymbol A$，必存在正交矩阵 $\boldsymbol Q$，使得 $\boldsymbol Q^T\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda=\begin{pmatrix}\lambda_1&&&\\&\lambda_2&&\\&&\ddots&\\&&&\lambda_n\end{pmatrix}$，其中 $\lambda_1,\lambda_2,\cdots,\lambda_n$ 为实对称矩阵 $\boldsymbol A$ 的 $n$ 个特征值。
			
			??? note "证明"
				对于实对称矩阵 $\boldsymbol A$，存在正交阵 $\boldsymbol Q$ 使得 $\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol Q^T\boldsymbol A\boldsymbol A=\boldsymbol \Lambda=\begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}$。
				
				$f=\boldsymbol x^T\boldsymbol A\boldsymbol x\xlongequal{\boldsymbol x=\boldsymbol Q\boldsymbol y}(\boldsymbol Q\boldsymbol y)^T\boldsymbol A(\boldsymbol Q\boldsymbol y)=\boldsymbol y^T\boldsymbol Q^T\boldsymbol A\boldsymbol Q\boldsymbol y=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y=\lambda_1y_1^2+\lambda_2y_2^2+\cdots+\lambda_ny_n^2$
			
			且若 $\boldsymbol Q$ 为正交矩阵且 $\boldsymbol x=\boldsymbol Q\boldsymbol y$ 化为标准形，则一定有 $\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol Q^T\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda=\begin{pmatrix}\lambda_1&&\\&\ddots&\\&&\lambda_n\end{pmatrix}$。
			
			??? note "证明"
				$f=\boldsymbol x^T\boldsymbol A\boldsymbol x\xlongequal{\boldsymbol x=\boldsymbol Q\boldsymbol y}(\boldsymbol Q\boldsymbol y)^T\boldsymbol A(\boldsymbol Q\boldsymbol y)=\boldsymbol y^T\boldsymbol Q^T\boldsymbol A\boldsymbol Q\boldsymbol y$，由于 $\boldsymbol A$ 是对称矩阵，则 $\boldsymbol Q^T\boldsymbol A\boldsymbol Q$ 和 $\boldsymbol \Lambda$ 均为对称矩阵，则 $f=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y\Leftrightarrow\boldsymbol Q^T\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda$
				
				又 $\boldsymbol Q$ 为正交矩阵，则 $f=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y\Leftrightarrow \boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda$。
			
			???+ example "例题"
				已知 $f=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 经正交变换化为标准形 $y_1^2+2y_2^2-3y_3^2$，求 $|\boldsymbol A|$。
				
				??? note "解答"
					由于是正交变换为标准形的，所以 $\lambda_1=1,\lambda_2=2,\lambda_3=-3$，$|\boldsymbol A|=\lambda_1\lambda_2\lambda_3=-6$。

	- 正交变换化二次型为标准形
		
        ① 写二次型矩阵 $\boldsymbol A$；② 由实对称矩阵的正交相似对角化，得到 $\boldsymbol Q$；③ 令 $\boldsymbol x=\boldsymbol Q\boldsymbol y$，将二次型 $f=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 化为标准形 $f=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y=\lambda_1y_1^2+\lambda_2y_2^2+\cdots+\lambda_ny_n^2$，注意这里 $\lambda_i$ 的顺序与 $\boldsymbol Q$ 的列对应。

### 配方法化二次型为标准形

- 任一个 $n$ 元二次型 $f(x_1,x_2,\cdots,x_n)=\boldsymbol x^T\boldsymbol A\boldsymbol x$，都可以通过可逆线性变换 $\boldsymbol x=\boldsymbol C\boldsymbol y$（其中 $\boldsymbol C$ 为可逆阵）化为标准形 $\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y$，其中 $\boldsymbol \Lambda=\boldsymbol C^T\boldsymbol A\boldsymbol C$，即 $\boldsymbol x^T\boldsymbol A\boldsymbol x=\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y=d_1y_1^2+d_2y_2^2+\cdots+d_ny_n^2$（其中 $d_i$ 为实数）。

	矩阵表述：任一个 $n$ 阶实对称矩阵 $\boldsymbol A$，必存在可逆矩阵 $\boldsymbol C$，使得 $\boldsymbol C^T\boldsymbol A\boldsymbol C=\boldsymbol \Lambda$，即必有 $\boldsymbol A$ 与对角阵 $\boldsymbol \Lambda$ 合同。

- 通过配方法化二次型为标准形

	???+ example "例题"
		用配方法将二次型 $f=2x_1^2+x_2^2-4x_1x_2-4x_2x_3$ 化为标准形，并写出所用的可逆线性变换矩阵。
		
		??? note "解答"
			$\begin{aligned}f&=2(x_1^2-2x_1x_2+x_2^2)-x_2^2-4x_2x_3\\&=2(x_1-x_2)^2-(x_2^2+4x_2x_3+4x_3^2)+4x_3^2\\&=2(x_1-x_2)^2-(x_2+2x_3)^2+4x_3^2\end{aligned}$
			
			令 $\begin{cases}y_1=x_1-x_2\\y_2=x_2+2x_3\\y_3=x_3\end{cases}$，则（由下往上反解）$\begin{cases}x_1=y_1+y_2-2y_3\\x_2=y_2-2y_3\\x_3=y_3\end{cases}$
			
			$\boldsymbol C=\begin{pmatrix}1&1&-2\\0&1&-2\\0&0&1\end{pmatrix}$
			
			即经可逆线性变换 $\boldsymbol x=\boldsymbol C\boldsymbol y$，将原二次型化为标准形 $f=2y_1^2-y_2^2+4y_3^2$。
			
			???+ tip
				同理，令 $\begin{cases}y_1=\sqrt 2 (x_1-x_2)\\y_2=x_2+2x_3\\y_3=2x_3\end{cases}$，得到 $f=y_1^2-y_2^2+y_3^2$，说明标准形不唯一。
		
	???+ info
		配方法得到的 $\boldsymbol C$ 一定可逆，因为可以得到对角线所有元素非零的上三角矩阵。注意形如 $f=(x_1+x_2)^2+(x_2+x_3)^2$ 要补上 $+0\cdot x_3$，令 $\begin{cases}y_1=x_1+x_2\\y_2=x_2+x_3\\y_3=x_3\end{cases}$
	
	对比：配方是先求 $\boldsymbol y^Y\boldsymbol \Lambda\boldsymbol y$（标准形）再得 $\boldsymbol x=\boldsymbol C\boldsymbol y$；正交是先确定 $\boldsymbol x=\boldsymbol Q\boldsymbol y$ 再写 $\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y$。

### 惯性指数、二次型的规范形

- 惯性定理、二次型的规范形

	- 惯性指数
	
		设二次型的标准形为 $f=d_1y_1^2+d_2y_2^2+\cdots+d_ny_n^2$，其中，正平方项的个数称为正惯性指数，用 $p$ 表示；负平方项的个数称为负惯性指数，用 $q$ 表示。
	
	- 惯性定理
	
		对于一个二次型，虽然选取不同可逆线性变换得到的标准形不唯一，但标准形平方项系数中，正平方项的个数 $p$ 和负平方项的个数 $q$ 是由原二次型唯一确定的。事实上，在可逆线性变换下，二次型的秩，正、负惯性指数，正定性都保持不变。
		
		注：由于 $f=\boldsymbol x^T\boldsymbol A\boldsymbol x\xlongequal{\boldsymbol x=\boldsymbol Q\boldsymbol y}\boldsymbol y^T\boldsymbol \Lambda\boldsymbol y=\lambda_1y_1^2+\lambda_2y_2^2+\cdots+\lambda_ny_n^2$，所以 $p=$ 二次型矩阵 $\boldsymbol A$ 正特征值的个数，$q=$ 二次型矩阵 $\boldsymbol A$ 负特征值的个数。
		
		推论：对于二次型的矩阵 $\boldsymbol A$，有 $r(\boldsymbol A)=p+q$，即实对称矩阵 $\boldsymbol A$ 有 $p+q$ 个非零特征值。
		
		（因为对于实对称矩阵 $\boldsymbol A$，$r(\boldsymbol A)=\boldsymbol A$ 的非零特征值个数）
		
	- 二次型的规范形
	
		二次型的规范形的定义：当标准形中的系数 $d_i\in\{1,-1,0\}$ 时，则称其为二次型的规范形。
		
		定理：任一实二次型 $f$ 都可经可逆线性变换化为规范形。$f=z_1^2+z_2^2+\cdots+z_p^2-z_{p+1}^2-\cdots-z_r^2$，其中，$r$ 为 $\boldsymbol A$ 的秩，$p$ 为正惯性指数，$r-p$ 为负惯性指数。
		
		???+ example "例题"
			二次型 $f=2x_1^2+x_2^2-4x_1x_2-4x_2x_3$ 的规范形、秩、正惯性指数、负惯性指数。
			
			??? note "解答"
				$f=2(x_1-x_2)^2-x_2^2-4x_2x_3=2(x_1-x_2)^2-(x_2-2x_3)^2+4x_3^2$，则规范形 $f=y_1^2-y_2^2+y_3^2$，$p=2,q=1,r=3$

### 合同

- 矩阵的合同

	- 合同的定义：设 $\boldsymbol A$ 与 $\boldsymbol B$ 都是 $n$ 阶方阵，若存在可逆矩阵 $\boldsymbol C$ 使得 $\boldsymbol B=\boldsymbol C^T\boldsymbol A\boldsymbol C$，则称 $\boldsymbol A$ 与 $\boldsymbol B$ 合同。
	- 关于合同的命题
	
		① 任一实对称矩阵合同于一个对角矩阵（因为 $\forall$ 实对称 $\boldsymbol A$，$\exists \boldsymbol Q$，$\boldsymbol Q^T\boldsymbol A\boldsymbol Q=\boldsymbol \Lambda$）
		
		② 实对称矩阵 $\boldsymbol A$ 与 $\boldsymbol B$ 合同 $\Leftrightarrow$ $\boldsymbol x^T\boldsymbol A\boldsymbol x$ 和 $\boldsymbol x^T\boldsymbol B\boldsymbol x$ 有相同的正负惯性指数（$\boldsymbol A$ 与 $\boldsymbol B$ 特征值符号相同）
		
		③ 实对称矩阵 $\boldsymbol A$ 与 $\boldsymbol B$ 合同 $\Rightarrow$ $r(\boldsymbol A)=r(\boldsymbol B)$，$\boldsymbol A^T$ 与 $\boldsymbol B^T$ 合同，$\boldsymbol A^{-1}$ 与 $\boldsymbol B^{-1}$ 合同
		
		④ 实对称矩阵 $\boldsymbol A$ 与 $\boldsymbol B$ 相似 $\Rightarrow$ $\boldsymbol A$ 与 $\boldsymbol B$ 合同
		
		???+ example "例题"
			矩阵 $\boldsymbol A=\begin{pmatrix}1&0\\0&-2\end{pmatrix}$ 与 $\boldsymbol B=\begin{pmatrix}-1&0\\0&3\end{pmatrix}$ 是否等价、相似、合同？
			
			??? note "解答"
				$\lambda_A=1,-2$，$\lambda_B=-1,3$
				
				特征值不同 $\Rightarrow$ 不相似
				
				实对称 且 特征值符号相同 $\Leftrightarrow$ 合同
				
				同型 且 $r(\boldsymbol A)=r(\boldsymbol B)$ $\Leftrightarrow$ 等价
				
		???+ tip
			实对称矩阵 $\boldsymbol A$ 与 $\boldsymbol B$：相似（需 $\lambda$ 同）$\Rightarrow$ 合同（$\lambda$ 符号同）$\Rightarrow$ 等价（$r$ 同，即 $p+q$ 同）

### 正定

- 正定二次型、正定矩阵

	- 二次型正定（对称矩阵 $\boldsymbol A$ 正定）
	
		定义：设二次型 $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$，如果对任何 $\boldsymbol x\neq \boldsymbol 0$ 都有 $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x>0$，则称 $f$ 为正定二次型，并称对称矩阵 $\boldsymbol A$ 为正定矩阵。
		
	- 二次型 $f$ 正定（实对称矩阵 $\boldsymbol A$ 正定）的充要条件
	
		$f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 正定
		
		$\Leftrightarrow$ 对任何 $\boldsymbol x\neq \boldsymbol 0$ 恒有 $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x>0$（定义，证 $f$ 正定常用）
		
		$\Leftrightarrow$ $f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 的标准形的 $n$ 个系数全大于 $0$
		
		$\Leftrightarrow$ $\boldsymbol A$ 合同于单位矩阵，即存在可逆矩阵 $\boldsymbol C$ 使得 $\boldsymbol A=\boldsymbol C^T\boldsymbol C$
		
		$\Leftrightarrow$ $\boldsymbol A$ 的正惯性指数 $p$ 等于其阶数 $n$
		
		$\Leftrightarrow$ $\boldsymbol A$ 的所有特征值都是正数（证 $f$ 正定常用）
		
		$\Leftrightarrow$ $\boldsymbol A$ 的顺序主子式全大于 $0$（证 $f$ 正定常用）
		
		推论：若 $\boldsymbol A$ 为正定矩阵，则 $f(\boldsymbol A)=a_m\boldsymbol A^m+a_{m-1}\boldsymbol A^{m-1}+\cdots+a_0\boldsymbol E$（其中 $a_i\geq 0$ 且不全为 $0$），$\boldsymbol A^{-1}$，$\boldsymbol A^*$ 都是正定矩阵。（可从 $\lambda$ 的角度证明）
		
		???+ example "例题"
			设 $\boldsymbol A$ 是 $n$ 阶实对称阵，且 $\boldsymbol A^3+3\boldsymbol A-2\boldsymbol E=\boldsymbol 0$。证明：$\boldsymbol A$ 正定。
			
			??? note "解答"
				设 $\lambda$ 是 $\boldsymbol A$ 的任一特征值，则 $\lambda^3+3\lambda-2=0$。
				
				由于 $\boldsymbol A$ 是实对称阵 $\Rightarrow$ $\boldsymbol A$ 的特征值 $\lambda$ 为实数。
				
				若 $\lambda\leq 0$，有 $\lambda^3+3\lambda-2\leq -2<0$ 矛盾。
				
				故 $\lambda>0$，即 $\boldsymbol A$ 正定。
	
	- 二次型 $f$ 正定（实对称矩阵 $\boldsymbol A$ 正定）的必要条件
	
		$f(\boldsymbol x)=\boldsymbol x^T\boldsymbol A\boldsymbol x$ 正定 $\Rightarrow$
		
		① $\boldsymbol A$ 是实对称矩阵；
		
		② $\forall i$，$a_{ii}>0$（常用）
		
		③ $|\boldsymbol A|>0$（常用），从而 $\boldsymbol A$ 可逆
		
		④ $\boldsymbol A$ 中最大的数落在主对角线上
		
		
	
		